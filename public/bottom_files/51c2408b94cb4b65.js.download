(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,174429,(t,e,r)=>{"use strict";function n(t){if(!Number.isSafeInteger(t)||t<0)throw Error("positive integer expected, got "+t)}function i(t,...e){if(!(t instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name))throw Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw Error("Uint8Array expected of length "+e+", got length="+t.length)}Object.defineProperty(r,"__esModule",{value:!0}),r.anumber=n,r.abytes=i,r.ahash=function(t){if("function"!=typeof t||"function"!=typeof t.create)throw Error("Hash should be wrapped by utils.wrapConstructor");n(t.outputLen),n(t.blockLen)},r.aexists=function(t,e=!0){if(t.destroyed)throw Error("Hash instance has been destroyed");if(e&&t.finished)throw Error("Hash#digest() has already been called")},r.aoutput=function(t,e){i(t);let r=e.outputLen;if(t.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}},581918,(t,e,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.crypto=void 0,r.crypto="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0},857024,(t,e,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Hash=r.nextTick=r.byteSwapIfBE=r.isLE=void 0,r.isBytes=function(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name},r.u8=function(t){return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)},r.u32=function(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))},r.createView=function(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)},r.rotr=function(t,e){return t<<32-e|t>>>e},r.rotl=function(t,e){return t<<e|t>>>32-e>>>0},r.byteSwap=o,r.byteSwap32=function(t){for(let e=0;e<t.length;e++)t[e]=o(t[e])},r.bytesToHex=function(t){(0,i.abytes)(t);let e="";for(let r=0;r<t.length;r++)e+=s[t[r]];return e},r.hexToBytes=function(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);let e=t.length,r=e/2;if(e%2)throw Error("hex string expected, got unpadded hex of length "+e);let n=new Uint8Array(r);for(let e=0,i=0;e<r;e++,i+=2){let r=a(t.charCodeAt(i)),o=a(t.charCodeAt(i+1));if(void 0===r||void 0===o)throw Error('hex string expected, got non-hex character "'+(t[i]+t[i+1])+'" at index '+i);n[e]=16*r+o}return n},r.asyncLoop=l,r.utf8ToBytes=f,r.toBytes=u,r.concatBytes=function(...t){let e=0;for(let r=0;r<t.length;r++){let n=t[r];(0,i.abytes)(n),e+=n.length}let r=new Uint8Array(e);for(let e=0,n=0;e<t.length;e++){let i=t[e];r.set(i,n),n+=i.length}return r},r.checkOpts=function(t,e){if(void 0!==e&&"[object Object]"!==({}).toString.call(e))throw Error("Options should be object or undefined");return Object.assign(t,e)},r.wrapConstructor=function(t){let e=e=>t().update(u(e)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e},r.wrapConstructorWithOpts=function(t){let e=(e,r)=>t(r).update(u(e)).digest(),r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=e=>t(e),e},r.wrapXOFConstructorWithOpts=function(t){let e=(e,r)=>t(r).update(u(e)).digest(),r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=e=>t(e),e},r.randomBytes=function(t=32){if(n.crypto&&"function"==typeof n.crypto.getRandomValues)return n.crypto.getRandomValues(new Uint8Array(t));if(n.crypto&&"function"==typeof n.crypto.randomBytes)return n.crypto.randomBytes(t);throw Error("crypto.getRandomValues must be defined")};let n=t.r(581918),i=t.r(174429);function o(t){return t<<24&0xff000000|t<<8&0xff0000|t>>>8&65280|t>>>24&255}r.isLE=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0],r.byteSwapIfBE=r.isLE?t=>t:t=>o(t);let s=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function a(t){return t>=48&&t<=57?t-48:t>=65&&t<=70?t-55:t>=97&&t<=102?t-87:void 0}async function l(t,e,n){let i=Date.now();for(let o=0;o<t;o++){n(o);let t=Date.now()-i;t>=0&&t<e||(await (0,r.nextTick)(),i+=t)}}function f(t){if("string"!=typeof t)throw Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function u(t){return"string"==typeof t&&(t=f(t)),(0,i.abytes)(t),t}r.nextTick=async()=>{},r.Hash=class{clone(){return this._cloneInto()}}},853146,(t,e,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.HashMD=void 0,r.setBigUint64=o,r.Chi=function(t,e,r){return t&e^~t&r},r.Maj=function(t,e,r){return t&e^t&r^e&r};let n=t.r(174429),i=t.r(857024);function o(t,e,r,n){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,r,n);let i=BigInt(32),o=BigInt(0xffffffff),s=Number(r>>i&o),a=Number(r&o),l=4*!!n,f=4*!n;t.setUint32(e+l,s,n),t.setUint32(e+f,a,n)}class s extends i.Hash{constructor(t,e,r,n){super(),this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=(0,i.createView)(this.buffer)}update(t){(0,n.aexists)(this);let{view:e,buffer:r,blockLen:o}=this,s=(t=(0,i.toBytes)(t)).length;for(let n=0;n<s;){let a=Math.min(o-this.pos,s-n);if(a===o){let e=(0,i.createView)(t);for(;o<=s-n;n+=o)this.process(e,n);continue}r.set(t.subarray(n,n+a),this.pos),this.pos+=a,n+=a,this.pos===o&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){(0,n.aexists)(this),(0,n.aoutput)(t,this),this.finished=!0;let{buffer:e,view:r,blockLen:s,isLE:a}=this,{pos:l}=this;e[l++]=128,this.buffer.subarray(l).fill(0),this.padOffset>s-l&&(this.process(r,0),l=0);for(let t=l;t<s;t++)e[t]=0;o(r,s-8,BigInt(8*this.length),a),this.process(r,0);let f=(0,i.createView)(t),u=this.outputLen;if(u%4)throw Error("_sha2: outputLen should be aligned to 32bit");let c=u/4,h=this.get();if(c>h.length)throw Error("_sha2: outputLen bigger than state");for(let t=0;t<c;t++)f.setUint32(4*t,h[t],a)}digest(){let{buffer:t,outputLen:e}=this;this.digestInto(t);let r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:e,buffer:r,length:n,finished:i,destroyed:o,pos:s}=this;return t.length=n,t.pos=s,t.finished=i,t.destroyed=o,n%e&&t.buffer.set(r),t}}r.HashMD=s},186016,(t,e,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.sha224=r.sha256=r.SHA256=void 0;let n=t.r(853146),i=t.r(857024),o=new Uint32Array([0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2]),s=new Uint32Array([0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19]),a=new Uint32Array(64);class l extends n.HashMD{constructor(){super(64,32,8,!1),this.A=0|s[0],this.B=0|s[1],this.C=0|s[2],this.D=0|s[3],this.E=0|s[4],this.F=0|s[5],this.G=0|s[6],this.H=0|s[7]}get(){let{A:t,B:e,C:r,D:n,E:i,F:o,G:s,H:a}=this;return[t,e,r,n,i,o,s,a]}set(t,e,r,n,i,o,s,a){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(t,e){for(let r=0;r<16;r++,e+=4)a[r]=t.getUint32(e,!1);for(let t=16;t<64;t++){let e=a[t-15],r=a[t-2],n=(0,i.rotr)(e,7)^(0,i.rotr)(e,18)^e>>>3,o=(0,i.rotr)(r,17)^(0,i.rotr)(r,19)^r>>>10;a[t]=o+a[t-7]+n+a[t-16]|0}let{A:r,B:s,C:l,D:f,E:u,F:c,G:h,H:d}=this;for(let t=0;t<64;t++){let e=d+((0,i.rotr)(u,6)^(0,i.rotr)(u,11)^(0,i.rotr)(u,25))+(0,n.Chi)(u,c,h)+o[t]+a[t]|0,g=((0,i.rotr)(r,2)^(0,i.rotr)(r,13)^(0,i.rotr)(r,22))+(0,n.Maj)(r,s,l)|0;d=h,h=c,c=u,u=f+e|0,f=l,l=s,s=r,r=e+g|0}r=r+this.A|0,s=s+this.B|0,l=l+this.C|0,f=f+this.D|0,u=u+this.E|0,c=c+this.F|0,h=h+this.G|0,d=d+this.H|0,this.set(r,s,l,f,u,c,h,d)}roundClean(){a.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}r.SHA256=l;class f extends l{constructor(){super(),this.A=-0x3efa6128,this.B=0x367cd507,this.C=0x3070dd17,this.D=-0x8f1a6c7,this.E=-4191439,this.F=0x68581511,this.G=0x64f98fa7,this.H=-0x4105b05c,this.outputLen=28}}r.sha256=(0,i.wrapConstructor)(()=>new l),r.sha224=(0,i.wrapConstructor)(()=>new f)},249996,(t,e,r)=>{"use strict";e.exports=function(t){if(t.length>=255)throw TypeError("Alphabet too long");for(var e=new Uint8Array(256),r=0;r<e.length;r++)e[r]=255;for(var n=0;n<t.length;n++){var i=t.charAt(n),o=i.charCodeAt(0);if(255!==e[o])throw TypeError(i+" is ambiguous");e[o]=n}var s=t.length,a=t.charAt(0),l=Math.log(s)/Math.log(256),f=Math.log(256)/Math.log(s);function u(t){if("string"!=typeof t)throw TypeError("Expected String");if(0===t.length)return new Uint8Array;for(var r=0,n=0,i=0;t[r]===a;)n++,r++;for(var o=(t.length-r)*l+1>>>0,f=new Uint8Array(o);t[r];){var u=t.charCodeAt(r);if(u>255)return;var c=e[u];if(255===c)return;for(var h=0,d=o-1;(0!==c||h<i)&&-1!==d;d--,h++)c+=s*f[d]>>>0,f[d]=c%256>>>0,c=c/256>>>0;if(0!==c)throw Error("Non-zero carry");i=h,r++}for(var g=o-i;g!==o&&0===f[g];)g++;for(var y=new Uint8Array(n+(o-g)),p=n;g!==o;)y[p++]=f[g++];return y}return{encode:function(e){if(e instanceof Uint8Array||(ArrayBuffer.isView(e)?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):Array.isArray(e)&&(e=Uint8Array.from(e))),!(e instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===e.length)return"";for(var r=0,n=0,i=0,o=e.length;i!==o&&0===e[i];)i++,r++;for(var l=(o-i)*f+1>>>0,u=new Uint8Array(l);i!==o;){for(var c=e[i],h=0,d=l-1;(0!==c||h<n)&&-1!==d;d--,h++)c+=256*u[d]>>>0,u[d]=c%s>>>0,c=c/s>>>0;if(0!==c)throw Error("Non-zero carry");n=h,i++}for(var g=l-n;g!==l&&0===u[g];)g++;for(var y=a.repeat(r);g<l;++g)y+=t.charAt(u[g]);return y},decodeUnsafe:u,decode:function(t){var e=u(t);if(e)return e;throw Error("Non-base"+s+" character")}}}},923742,(t,e,r)=>{e.exports=t.r(249996)("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},638712,(t,e,r)=>{"use strict";var n=t.r(923742);e.exports=function(t){function e(e){var r=e.slice(0,-4),n=e.slice(-4),i=t(r);if(!(n[0]^i[0]|n[1]^i[1]|n[2]^i[2]|n[3]^i[3]))return r}return{encode:function(e){var r=Uint8Array.from(e),i=t(r),o=r.length+4,s=new Uint8Array(o);return s.set(r,0),s.set(i.subarray(0,4),r.length),n.encode(s,o)},decode:function(r){var i=e(n.decode(r),t);if(!i)throw Error("Invalid checksum");return i},decodeUnsafe:function(t){var r=n.decodeUnsafe(t);if(r)return e(r)}}}},666826,(t,e,r)=>{"use strict";var{sha256:n}=t.r(186016);e.exports=t.r(638712)(function(t){return n(n(t))})},120552,(t,e,r)=>{"use strict";e.exports=function(t){if(t.length>=255)throw TypeError("Alphabet too long");for(var e=new Uint8Array(256),r=0;r<e.length;r++)e[r]=255;for(var n=0;n<t.length;n++){var i=t.charAt(n),o=i.charCodeAt(0);if(255!==e[o])throw TypeError(i+" is ambiguous");e[o]=n}var s=t.length,a=t.charAt(0),l=Math.log(s)/Math.log(256),f=Math.log(256)/Math.log(s);function u(t){if("string"!=typeof t)throw TypeError("Expected String");if(0===t.length)return new Uint8Array;for(var r=0,n=0,i=0;t[r]===a;)n++,r++;for(var o=(t.length-r)*l+1>>>0,f=new Uint8Array(o);t[r];){var u=t.charCodeAt(r);if(u>255)return;var c=e[u];if(255===c)return;for(var h=0,d=o-1;(0!==c||h<i)&&-1!==d;d--,h++)c+=s*f[d]>>>0,f[d]=c%256>>>0,c=c/256>>>0;if(0!==c)throw Error("Non-zero carry");i=h,r++}for(var g=o-i;g!==o&&0===f[g];)g++;for(var y=new Uint8Array(n+(o-g)),p=n;g!==o;)y[p++]=f[g++];return y}return{encode:function(e){if(e instanceof Uint8Array||(ArrayBuffer.isView(e)?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):Array.isArray(e)&&(e=Uint8Array.from(e))),!(e instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===e.length)return"";for(var r=0,n=0,i=0,o=e.length;i!==o&&0===e[i];)i++,r++;for(var l=(o-i)*f+1>>>0,u=new Uint8Array(l);i!==o;){for(var c=e[i],h=0,d=l-1;(0!==c||h<n)&&-1!==d;d--,h++)c+=256*u[d]>>>0,u[d]=c%s>>>0,c=c/s>>>0;if(0!==c)throw Error("Non-zero carry");n=h,i++}for(var g=l-n;g!==l&&0===u[g];)g++;for(var y=a.repeat(r);g<l;++g)y+=t.charAt(u[g]);return y},decodeUnsafe:u,decode:function(t){var e=u(t);if(e)return e;throw Error("Non-base"+s+" character")}}}},683856,(t,e,r)=>{e.exports=t.r(120552)("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},284795,356026,784503,t=>{"use strict";let e;function r(t){if(!Number.isSafeInteger(t)||t<0)throw Error(`positive integer expected, not ${t}`)}function n(t,...e){if(!(t instanceof Uint8Array||null!=t&&"object"==typeof t&&"Uint8Array"===t.constructor.name))throw Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function i(t){if("function"!=typeof t||"function"!=typeof t.create)throw Error("Hash should be wrapped by utils.wrapConstructor");r(t.outputLen),r(t.blockLen)}function o(t,e=!0){if(t.destroyed)throw Error("Hash instance has been destroyed");if(e&&t.finished)throw Error("Hash#digest() has already been called")}let s="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,a=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),l=(t,e)=>t<<32-e|t>>>e;function f(t){if("string"!=typeof t)throw Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function u(t){return"string"==typeof t&&(t=f(t)),n(t),t}function c(...t){let e=0;for(let r=0;r<t.length;r++){let i=t[r];n(i),e+=i.length}let r=new Uint8Array(e);for(let e=0,n=0;e<t.length;e++){let i=t[e];r.set(i,n),n+=i.length}return r}new Uint8Array(new Uint32Array([0x11223344]).buffer)[0];class h{clone(){return this._cloneInto()}}function d(t){let e=e=>t().update(u(e)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function g(t=32){if(s&&"function"==typeof s.getRandomValues)return s.getRandomValues(new Uint8Array(t));throw Error("crypto.getRandomValues must be defined")}class y extends h{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,i(t);const r=u(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,o=new Uint8Array(n);o.set(r.length>n?t.create().update(r).digest():r);for(let t=0;t<o.length;t++)o[t]^=54;this.iHash.update(o),this.oHash=t.create();for(let t=0;t<o.length;t++)o[t]^=106;this.oHash.update(o),o.fill(0)}update(t){return o(this),this.iHash.update(t),this}digestInto(t){o(this),n(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:e,iHash:r,finished:n,destroyed:i,blockLen:o,outputLen:s}=this;return t.finished=n,t.destroyed=i,t.blockLen=o,t.outputLen=s,t.oHash=e._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}let p=(t,e,r)=>new y(t,e).update(r).digest();p.create=(t,e)=>new y(t,e);let b=BigInt(0),x=BigInt(1),w=BigInt(2);function m(t){return t instanceof Uint8Array||null!=t&&"object"==typeof t&&"Uint8Array"===t.constructor.name}function E(t){if(!m(t))throw Error("Uint8Array expected")}let A=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function B(t){E(t);let e="";for(let r=0;r<t.length;r++)e+=A[t[r]];return e}function v(t){let e=t.toString(16);return 1&e.length?`0${e}`:e}function S(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);return BigInt(""===t?"0":`0x${t}`)}function U(t){return t>=48&&t<=57?t-48:t>=65&&t<=70?t-55:t>=97&&t<=102?t-87:void 0}function I(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);let e=t.length,r=e/2;if(e%2)throw Error("padded hex string expected, got unpadded hex of length "+e);let n=new Uint8Array(r);for(let e=0,i=0;e<r;e++,i+=2){let r=U(t.charCodeAt(i)),o=U(t.charCodeAt(i+1));if(void 0===r||void 0===o)throw Error('hex string expected, got non-hex character "'+(t[i]+t[i+1])+'" at index '+i);n[e]=16*r+o}return n}function O(t){return S(B(t))}function H(t){return E(t),S(B(Uint8Array.from(t).reverse()))}function L(t,e){return I(t.toString(16).padStart(2*e,"0"))}function T(t,e){return L(t,e).reverse()}function R(t){return I(v(t))}function N(t,e,r){let n;if("string"==typeof e)try{n=I(e)}catch(r){throw Error(`${t} must be valid hex string, got "${e}". Cause: ${r}`)}else if(m(e))n=Uint8Array.from(e);else throw Error(`${t} must be hex string or Uint8Array`);let i=n.length;if("number"==typeof r&&i!==r)throw Error(`${t} expected ${r} bytes, got ${i}`);return n}function q(...t){let e=0;for(let r=0;r<t.length;r++){let n=t[r];E(n),e+=n.length}let r=new Uint8Array(e);for(let e=0,n=0;e<t.length;e++){let i=t[e];r.set(i,n),n+=i.length}return r}function $(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return 0===r}function P(t){if("string"!=typeof t)throw Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function z(t){let e;for(e=0;t>b;t>>=x,e+=1);return e}function D(t,e){return t>>BigInt(e)&x}function F(t,e,r){return t|(r?x:b)<<BigInt(e)}let k=t=>(w<<BigInt(t-1))-x,C=t=>new Uint8Array(t);function _(t,e,r){if("number"!=typeof t||t<2)throw Error("hashLen must be a number");if("number"!=typeof e||e<2)throw Error("qByteLen must be a number");if("function"!=typeof r)throw Error("hmacFn must be a function");let n=C(t),i=C(t),o=0,s=()=>{n.fill(1),i.fill(0),o=0},a=(...t)=>r(i,n,...t),l=(t=C())=>{let e;if(i=a((e=[0],Uint8Array.from(e)),t),n=a(),0!==t.length){let e;i=a((e=[1],Uint8Array.from(e)),t),n=a()}},f=()=>{if(o++>=1e3)throw Error("drbg: tried 1000 values");let t=0,r=[];for(;t<e;){let e=(n=a()).slice();r.push(e),t+=n.length}return q(...r)};return(t,e)=>{let r;for(s(),l(t);!(r=e(f()));)l();return s(),r}}let M={bigint:t=>"bigint"==typeof t,function:t=>"function"==typeof t,boolean:t=>"boolean"==typeof t,string:t=>"string"==typeof t,stringOrUint8Array:t=>"string"==typeof t||m(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>"function"==typeof t&&Number.isSafeInteger(t.outputLen)};function V(t,e,r={}){let n=(e,r,n)=>{let i=M[r];if("function"!=typeof i)throw Error(`Invalid validator "${r}", expected function`);let o=t[e];if((!n||void 0!==o)&&!i(o,t))throw Error(`Invalid param ${String(e)}=${o} (${typeof o}), expected ${r}`)};for(let[t,r]of Object.entries(e))n(t,r,!1);for(let[t,e]of Object.entries(r))n(t,e,!0);return t}t.s(["abytes",()=>E,"bitGet",()=>D,"bitLen",()=>z,"bitMask",0,k,"bitSet",()=>F,"bytesToHex",()=>B,"bytesToNumberBE",()=>O,"bytesToNumberLE",()=>H,"concatBytes",()=>q,"createHmacDrbg",()=>_,"ensureBytes",()=>N,"equalBytes",()=>$,"hexToBytes",()=>I,"hexToNumber",()=>S,"isBytes",()=>m,"numberToBytesBE",()=>L,"numberToBytesLE",()=>T,"numberToHexUnpadded",()=>v,"numberToVarBytesBE",()=>R,"utf8ToBytes",()=>P,"validateObject",()=>V],257091);let Z=BigInt(0),j=BigInt(1),K=BigInt(2),G=BigInt(3),W=BigInt(4),Y=BigInt(5),J=BigInt(8);function X(t,e){let r=t%e;return r>=Z?r:e+r}BigInt(9),BigInt(16);function Q(t,e,r){let n=t;for(;e-- >Z;)n*=n,n%=r;return n}function tt(t,e){if(t===Z||e<=Z)throw Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=X(t,e),n=e,i=Z,o=j,s=j,a=Z;for(;r!==Z;){let t=n/r,e=n%r,l=i-s*t,f=o-a*t;n=r,r=e,i=s,o=a,s=l,a=f}if(n!==j)throw Error("invert: does not exist");return X(i,e)}let te=(t,e)=>(X(t,e)&j)===j,tr=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function tn(t){return V(t,tr.reduce((t,e)=>(t[e]="function",t),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"}))}function ti(t,e){let r=void 0!==e?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function to(t,e,r=!1,n={}){if(t<=Z)throw Error(`Expected Field ORDER > 0, got ${t}`);let{nBitLength:i,nByteLength:o}=ti(t,e);if(o>2048)throw Error("Field lengths over 2048 bytes are not supported");let s=function(t){if(t%W===G){let e=(t+j)/W;return function(t,r){let n=t.pow(r,e);if(!t.eql(t.sqr(n),r))throw Error("Cannot find square root");return n}}if(t%J===Y){let e=(t-Y)/J;return function(t,r){let n=t.mul(r,K),i=t.pow(n,e),o=t.mul(r,i),s=t.mul(t.mul(o,K),i),a=t.mul(o,t.sub(s,t.ONE));if(!t.eql(t.sqr(a),r))throw Error("Cannot find square root");return a}}return function(t){let e,r,n,i=(t-j)/K;for(e=t-j,r=0;e%K===Z;e/=K,r++);for(n=K;n<t&&function(t,e,r){if(r<=Z||e<Z)throw Error("Expected power/modulo > 0");if(r===j)return Z;let n=j;for(;e>Z;)e&j&&(n=n*t%r),t=t*t%r,e>>=j;return n}(n,i,t)!==t-j;n++);if(1===r){let e=(t+j)/W;return function(t,r){let n=t.pow(r,e);if(!t.eql(t.sqr(n),r))throw Error("Cannot find square root");return n}}let o=(e+j)/K;return function(t,s){if(t.pow(s,i)===t.neg(t.ONE))throw Error("Cannot find square root");let a=r,l=t.pow(t.mul(t.ONE,n),e),f=t.pow(s,o),u=t.pow(s,e);for(;!t.eql(u,t.ONE);){if(t.eql(u,t.ZERO))return t.ZERO;let e=1;for(let r=t.sqr(u);e<a&&!t.eql(r,t.ONE);e++)r=t.sqr(r);let r=t.pow(l,j<<BigInt(a-e-1));l=t.sqr(r),f=t.mul(f,r),u=t.mul(u,l),a=e}return f}}(t)}(t),a=Object.freeze({ORDER:t,BITS:i,BYTES:o,MASK:k(i),ZERO:Z,ONE:j,create:e=>X(e,t),isValid:e=>{if("bigint"!=typeof e)throw Error(`Invalid field element: expected bigint, got ${typeof e}`);return Z<=e&&e<t},is0:t=>t===Z,isOdd:t=>(t&j)===j,neg:e=>X(-e,t),eql:(t,e)=>t===e,sqr:e=>X(e*e,t),add:(e,r)=>X(e+r,t),sub:(e,r)=>X(e-r,t),mul:(e,r)=>X(e*r,t),pow:(t,e)=>(function(t,e,r){if(r<Z)throw Error("Expected power > 0");if(r===Z)return t.ONE;if(r===j)return e;let n=t.ONE,i=e;for(;r>Z;)r&j&&(n=t.mul(n,i)),i=t.sqr(i),r>>=j;return n})(a,t,e),div:(e,r)=>X(e*tt(r,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>tt(e,t),sqrt:n.sqrt||(t=>s(a,t)),invertBatch:t=>{let e,r,n;return e=Array(t.length),r=t.reduce((t,r,n)=>a.is0(r)?t:(e[n]=t,a.mul(t,r)),a.ONE),n=a.inv(r),t.reduceRight((t,r,n)=>a.is0(r)?t:(e[n]=a.mul(t,e[n]),a.mul(t,r)),n),e},cmov:(t,e,r)=>r?e:t,toBytes:t=>r?T(t,o):L(t,o),fromBytes:t=>{if(t.length!==o)throw Error(`Fp.fromBytes: expected ${o}, got ${t.length}`);return r?H(t):O(t)}});return Object.freeze(a)}function ts(t){if("bigint"!=typeof t)throw Error("field order must be bigint");return Math.ceil(t.toString(2).length/8)}function ta(t){let e=ts(t);return e+Math.ceil(e/2)}var tl,tf=t.i(257091);let tu=BigInt(0),tc=BigInt(1);function th(t,e){let r=(t,e)=>{let r=e.negate();return t?r:e},n=t=>({windows:Math.ceil(e/t)+1,windowSize:2**(t-1)});return{constTimeNegate:r,unsafeLadder(e,r){let n=t.ZERO,i=e;for(;r>tu;)r&tc&&(n=n.add(i)),i=i.double(),r>>=tc;return n},precomputeWindow(t,e){let{windows:r,windowSize:i}=n(e),o=[],s=t,a=s;for(let t=0;t<r;t++){a=s,o.push(a);for(let t=1;t<i;t++)a=a.add(s),o.push(a);s=a.double()}return o},wNAF(e,i,o){let{windows:s,windowSize:a}=n(e),l=t.ZERO,f=t.BASE,u=BigInt(2**e-1),c=2**e,h=BigInt(e);for(let t=0;t<s;t++){let e=t*a,n=Number(o&u);o>>=h,n>a&&(n-=c,o+=tc);let s=e+Math.abs(n)-1,d=t%2!=0,g=n<0;0===n?f=f.add(r(d,i[e])):l=l.add(r(g,i[s]))}return{p:l,f}},wNAFCached(t,e,r,n){let i=t._WINDOW_SIZE||1,o=e.get(t);return o||(o=this.precomputeWindow(t,i),1!==i&&e.set(t,n(o))),this.wNAF(i,o,r)}}}function td(t){return tn(t.Fp),V(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...ti(t.n,t.nBitLength),...t,...{p:t.Fp.ORDER}})}let{bytesToNumberBE:tg,hexToBytes:ty}=tf,tp={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(t){let{Err:e}=tp;if(t.length<2||2!==t[0])throw new e("Invalid signature integer tag");let r=t[1],n=t.subarray(2,r+2);if(!r||n.length!==r)throw new e("Invalid signature integer: wrong length");if(128&n[0])throw new e("Invalid signature integer: negative");if(0===n[0]&&!(128&n[1]))throw new e("Invalid signature integer: unnecessary leading zero");return{d:tg(n),l:t.subarray(r+2)}},toSig(t){let{Err:e}=tp,r="string"==typeof t?ty(t):t;tf.abytes(r);let n=r.length;if(n<2||48!=r[0])throw new e("Invalid signature tag");if(r[1]!==n-2)throw new e("Invalid signature: incorrect length");let{d:i,l:o}=tp._parseInt(r.subarray(2)),{d:s,l:a}=tp._parseInt(o);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s}},hexFromSig(t){let e=t=>8&Number.parseInt(t[0],16)?"00"+t:t,r=t=>{let e=t.toString(16);return 1&e.length?`0${e}`:e},n=e(r(t.s)),i=e(r(t.r)),o=n.length/2,s=i.length/2,a=r(o),l=r(s);return`30${r(s+o+4)}02${l}${i}02${a}${n}`}},tb=BigInt(0),tx=BigInt(1),tw=BigInt(2),tm=BigInt(3),tE=BigInt(4),tA=(t,e,r)=>t&e^~t&r,tB=(t,e,r)=>t&e^t&r^e&r;class tv extends h{constructor(t,e,r,n){super(),this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=a(this.buffer)}update(t){o(this);let{view:e,buffer:r,blockLen:n}=this,i=(t=u(t)).length;for(let o=0;o<i;){let s=Math.min(n-this.pos,i-o);if(s===n){let e=a(t);for(;n<=i-o;o+=n)this.process(e,o);continue}r.set(t.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===n&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){o(this);n(t);let e=this.outputLen;if(t.length<e)throw Error(`digestInto() expects output buffer of length at least ${e}`);this.finished=!0;let{buffer:r,view:i,blockLen:s,isLE:l}=this,{pos:f}=this;r[f++]=128,this.buffer.subarray(f).fill(0),this.padOffset>s-f&&(this.process(i,0),f=0);for(let t=f;t<s;t++)r[t]=0;!function(t,e,r,n){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,r,n);let i=BigInt(32),o=BigInt(0xffffffff),s=Number(r>>i&o),a=Number(r&o),l=4*!!n,f=4*!n;t.setUint32(e+l,s,n),t.setUint32(e+f,a,n)}(i,s-8,BigInt(8*this.length),l),this.process(i,0);let u=a(t),c=this.outputLen;if(c%4)throw Error("_sha2: outputLen should be aligned to 32bit");let h=c/4,d=this.get();if(h>d.length)throw Error("_sha2: outputLen bigger than state");for(let t=0;t<h;t++)u.setUint32(4*t,d[t],l)}digest(){let{buffer:t,outputLen:e}=this;this.digestInto(t);let r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:e,buffer:r,length:n,finished:i,destroyed:o,pos:s}=this;return t.length=n,t.pos=s,t.finished=i,t.destroyed=o,n%e&&t.buffer.set(r),t}}let tS=new Uint32Array([0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2]),tU=new Uint32Array([0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19]),tI=new Uint32Array(64);class tO extends tv{constructor(){super(64,32,8,!1),this.A=0|tU[0],this.B=0|tU[1],this.C=0|tU[2],this.D=0|tU[3],this.E=0|tU[4],this.F=0|tU[5],this.G=0|tU[6],this.H=0|tU[7]}get(){let{A:t,B:e,C:r,D:n,E:i,F:o,G:s,H:a}=this;return[t,e,r,n,i,o,s,a]}set(t,e,r,n,i,o,s,a){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(t,e){for(let r=0;r<16;r++,e+=4)tI[r]=t.getUint32(e,!1);for(let t=16;t<64;t++){let e=tI[t-15],r=tI[t-2],n=l(e,7)^l(e,18)^e>>>3,i=l(r,17)^l(r,19)^r>>>10;tI[t]=i+tI[t-7]+n+tI[t-16]|0}let{A:r,B:n,C:i,D:o,E:s,F:a,G:f,H:u}=this;for(let t=0;t<64;t++){let e=u+(l(s,6)^l(s,11)^l(s,25))+tA(s,a,f)+tS[t]+tI[t]|0,c=(l(r,2)^l(r,13)^l(r,22))+tB(r,n,i)|0;u=f,f=a,a=s,s=o+e|0,o=i,i=n,n=r,r=e+c|0}r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,f=f+this.G|0,u=u+this.H|0,this.set(r,n,i,o,s,a,f,u)}roundClean(){tI.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}let tH=d(()=>new tO);function tL(t,e){if(t<0||t>=1<<8*e)throw Error(`bad I2OSP call: value=${t} length=${e}`);let r=Array.from({length:e}).fill(0);for(let n=e-1;n>=0;n--)r[n]=255&t,t>>>=8;return new Uint8Array(r)}function tT(t){if(!Number.isSafeInteger(t))throw Error("number expected")}function tR(t,e,r){let n;V(r,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});let{p:i,k:o,m:s,hash:a,expand:l,DST:f}=r;E(t),tT(e);let u="string"==typeof f?P(f):f,c=Math.ceil((i.toString(2).length+o)/8),h=e*s*c;if("xmd"===l)n=function(t,e,r,n){E(t),E(e),tT(r),e.length>255&&(e=n(q(P("H2C-OVERSIZE-DST-"),e)));let{outputLen:i,blockLen:o}=n,s=Math.ceil(r/i);if(s>255)throw Error("Invalid xmd length");let a=q(e,tL(e.length,1)),l=tL(0,o),f=tL(r,2),u=Array(s),c=n(q(l,t,f,tL(0,1),a));u[0]=n(q(c,tL(1,1),a));for(let t=1;t<=s;t++){let e=[function(t,e){let r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t[n]^e[n];return r}(c,u[t-1]),tL(t+1,1),a];u[t]=n(q(...e))}return q(...u).slice(0,r)}(t,u,h,a);else if("xof"===l)n=function(t,e,r,n,i){if(E(t),E(e),tT(r),e.length>255){let t=Math.ceil(2*n/8);e=i.create({dkLen:t}).update(P("H2C-OVERSIZE-DST-")).update(e).digest()}if(r>65535||e.length>255)throw Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:r}).update(t).update(tL(r,2)).update(e).update(tL(e.length,1)).digest()}(t,u,h,o,a);else if("_internal_pass"===l)n=t;else throw Error('expand must be "xmd" or "xof"');let d=Array(e);for(let t=0;t<e;t++){let e=Array(s);for(let r=0;r<s;r++){let o=c*(r+t*s),a=n.subarray(o,o+c);e[r]=X(O(a),i)}d[t]=e}return d}function tN(t,e,r){if("function"!=typeof e)throw Error("mapToCurve() must be defined");return{hashToCurve(n,i){let o=tR(n,2,{...r,DST:r.DST,...i}),s=t.fromAffine(e(o[0])),a=t.fromAffine(e(o[1])),l=s.add(a).clearCofactor();return l.assertValidity(),l},encodeToCurve(n,i){let o=tR(n,1,{...r,DST:r.encodeDST,...i}),s=t.fromAffine(e(o[0])).clearCofactor();return s.assertValidity(),s}}}let tq=to(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),t$=tq.create(BigInt("-3")),tP=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),tz=(tl={a:t$,b:tP,Fp:tq,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},Object.freeze({...(e=t=>(function(t){let e,r=(e=td(t),tf.validateObject(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})),{Fp:n,n:i}=r,o=n.BYTES+1,s=2*n.BYTES+1;function a(t){return X(t,i)}let{ProjectivePoint:l,normPrivateKeyToScalar:f,weierstrassEquation:u,isWithinCurveOrder:c}=function(t){let e=function(t){let e=td(t);tf.validateObject(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof r||"bigint"!=typeof r.beta||"function"!=typeof r.splitScalar)throw Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}(t),{Fp:r}=e,n=e.toBytes||((t,e,n)=>{let i=e.toAffine();return tf.concatBytes(Uint8Array.from([4]),r.toBytes(i.x),r.toBytes(i.y))}),i=e.fromBytes||(t=>{let e=t.subarray(1);return{x:r.fromBytes(e.subarray(0,r.BYTES)),y:r.fromBytes(e.subarray(r.BYTES,2*r.BYTES))}});function o(t){let{a:n,b:i}=e,o=r.sqr(t),s=r.mul(o,t);return r.add(r.add(s,r.mul(t,n)),i)}if(!r.eql(r.sqr(e.Gy),o(e.Gx)))throw Error("bad generator point: equation left != right");function s(t){return"bigint"==typeof t&&tb<t&&t<e.n}function a(t){if(!s(t))throw Error("Expected valid bigint: 0 < bigint < curve.n")}function l(t){let r,{allowedPrivateKeyLengths:n,nByteLength:i,wrapPrivateKey:o,n:s}=e;if(n&&"bigint"!=typeof t){if(tf.isBytes(t)&&(t=tf.bytesToHex(t)),"string"!=typeof t||!n.includes(t.length))throw Error("Invalid key");t=t.padStart(2*i,"0")}try{r="bigint"==typeof t?t:tf.bytesToNumberBE(N("private key",t,i))}catch(e){throw Error(`private key must be ${i} bytes, hex or bigint, not ${typeof t}`)}return o&&(r=X(r,s)),a(r),r}let f=new Map;function u(t){if(!(t instanceof c))throw Error("ProjectivePoint expected")}class c{constructor(t,e,n){if(this.px=t,this.py=e,this.pz=n,null==t||!r.isValid(t))throw Error("x required");if(null==e||!r.isValid(e))throw Error("y required");if(null==n||!r.isValid(n))throw Error("z required")}static fromAffine(t){let{x:e,y:n}=t||{};if(!t||!r.isValid(e)||!r.isValid(n))throw Error("invalid affine point");if(t instanceof c)throw Error("projective point not allowed");let i=t=>r.eql(t,r.ZERO);return i(e)&&i(n)?c.ZERO:new c(e,n,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(t){let e=r.invertBatch(t.map(t=>t.pz));return t.map((t,r)=>t.toAffine(e[r])).map(c.fromAffine)}static fromHex(t){let e=c.fromAffine(i(N("pointHex",t)));return e.assertValidity(),e}static fromPrivateKey(t){return c.BASE.multiply(l(t))}_setWindowSize(t){this._WINDOW_SIZE=t,f.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!r.is0(this.py))return;throw Error("bad point: ZERO")}let{x:t,y:n}=this.toAffine();if(!r.isValid(t)||!r.isValid(n))throw Error("bad point: x or y not FE");let i=r.sqr(n),s=o(t);if(!r.eql(i,s))throw Error("bad point: equation left != right");if(!this.isTorsionFree())throw Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:t}=this.toAffine();if(r.isOdd)return!r.isOdd(t);throw Error("Field doesn't support isOdd")}equals(t){u(t);let{px:e,py:n,pz:i}=this,{px:o,py:s,pz:a}=t,l=r.eql(r.mul(e,a),r.mul(o,i)),f=r.eql(r.mul(n,a),r.mul(s,i));return l&&f}negate(){return new c(this.px,r.neg(this.py),this.pz)}double(){let{a:t,b:n}=e,i=r.mul(n,tm),{px:o,py:s,pz:a}=this,l=r.ZERO,f=r.ZERO,u=r.ZERO,h=r.mul(o,o),d=r.mul(s,s),g=r.mul(a,a),y=r.mul(o,s);return y=r.add(y,y),u=r.mul(o,a),u=r.add(u,u),l=r.mul(t,u),f=r.mul(i,g),f=r.add(l,f),l=r.sub(d,f),f=r.add(d,f),f=r.mul(l,f),l=r.mul(y,l),u=r.mul(i,u),g=r.mul(t,g),y=r.sub(h,g),y=r.mul(t,y),y=r.add(y,u),u=r.add(h,h),h=r.add(u,h),h=r.add(h,g),h=r.mul(h,y),f=r.add(f,h),g=r.mul(s,a),g=r.add(g,g),h=r.mul(g,y),l=r.sub(l,h),u=r.mul(g,d),u=r.add(u,u),new c(l,f,u=r.add(u,u))}add(t){u(t);let{px:n,py:i,pz:o}=this,{px:s,py:a,pz:l}=t,f=r.ZERO,h=r.ZERO,d=r.ZERO,g=e.a,y=r.mul(e.b,tm),p=r.mul(n,s),b=r.mul(i,a),x=r.mul(o,l),w=r.add(n,i),m=r.add(s,a);w=r.mul(w,m),m=r.add(p,b),w=r.sub(w,m),m=r.add(n,o);let E=r.add(s,l);return m=r.mul(m,E),E=r.add(p,x),m=r.sub(m,E),E=r.add(i,o),f=r.add(a,l),E=r.mul(E,f),f=r.add(b,x),E=r.sub(E,f),d=r.mul(g,m),f=r.mul(y,x),d=r.add(f,d),f=r.sub(b,d),d=r.add(b,d),h=r.mul(f,d),b=r.add(p,p),b=r.add(b,p),x=r.mul(g,x),m=r.mul(y,m),b=r.add(b,x),x=r.sub(p,x),x=r.mul(g,x),m=r.add(m,x),p=r.mul(b,m),h=r.add(h,p),p=r.mul(E,m),f=r.mul(w,f),f=r.sub(f,p),p=r.mul(w,b),d=r.mul(E,d),new c(f,h,d=r.add(d,p))}subtract(t){return this.add(t.negate())}is0(){return this.equals(c.ZERO)}wNAF(t){return d.wNAFCached(this,f,t,t=>{let e=r.invertBatch(t.map(t=>t.pz));return t.map((t,r)=>t.toAffine(e[r])).map(c.fromAffine)})}multiplyUnsafe(t){let n=c.ZERO;if(t===tb)return n;if(a(t),t===tx)return this;let{endo:i}=e;if(!i)return d.unsafeLadder(this,t);let{k1neg:o,k1:s,k2neg:l,k2:f}=i.splitScalar(t),u=n,h=n,g=this;for(;s>tb||f>tb;)s&tx&&(u=u.add(g)),f&tx&&(h=h.add(g)),g=g.double(),s>>=tx,f>>=tx;return o&&(u=u.negate()),l&&(h=h.negate()),h=new c(r.mul(h.px,i.beta),h.py,h.pz),u.add(h)}multiply(t){let n,i;a(t);let{endo:o}=e;if(o){let{k1neg:e,k1:s,k2neg:a,k2:l}=o.splitScalar(t),{p:f,f:u}=this.wNAF(s),{p:h,f:g}=this.wNAF(l);f=d.constTimeNegate(e,f),h=d.constTimeNegate(a,h),h=new c(r.mul(h.px,o.beta),h.py,h.pz),n=f.add(h),i=u.add(g)}else{let{p:e,f:r}=this.wNAF(t);n=e,i=r}return c.normalizeZ([n,i])[0]}multiplyAndAddUnsafe(t,e,r){let n=c.BASE,i=(t,e)=>e!==tb&&e!==tx&&t.equals(n)?t.multiply(e):t.multiplyUnsafe(e),o=i(this,e).add(i(t,r));return o.is0()?void 0:o}toAffine(t){let{px:e,py:n,pz:i}=this,o=this.is0();null==t&&(t=o?r.ONE:r.inv(i));let s=r.mul(e,t),a=r.mul(n,t),l=r.mul(i,t);if(o)return{x:r.ZERO,y:r.ZERO};if(!r.eql(l,r.ONE))throw Error("invZ was invalid");return{x:s,y:a}}isTorsionFree(){let{h:t,isTorsionFree:r}=e;if(t===tx)return!0;if(r)return r(c,this);throw Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:t,clearCofactor:r}=e;return t===tx?this:r?r(c,this):this.multiplyUnsafe(e.h)}toRawBytes(t=!0){return this.assertValidity(),n(c,this,t)}toHex(t=!0){return tf.bytesToHex(this.toRawBytes(t))}}c.BASE=new c(e.Gx,e.Gy,r.ONE),c.ZERO=new c(r.ZERO,r.ONE,r.ZERO);let h=e.nBitLength,d=th(c,e.endo?Math.ceil(h/2):h);return{CURVE:e,ProjectivePoint:c,normPrivateKeyToScalar:l,weierstrassEquation:o,isWithinCurveOrder:s}}({...r,toBytes(t,e,r){let i=e.toAffine(),o=n.toBytes(i.x),s=tf.concatBytes;return r?s(Uint8Array.from([e.hasEvenY()?2:3]),o):s(Uint8Array.from([4]),o,n.toBytes(i.y))},fromBytes(t){let e=t.length,r=t[0],i=t.subarray(1);if(e===o&&(2===r||3===r)){let t,e=tf.bytesToNumberBE(i);if(!(tb<e&&e<n.ORDER))throw Error("Point is not on curve");let o=u(e);try{t=n.sqrt(o)}catch(t){throw Error("Point is not on curve"+(t instanceof Error?": "+t.message:""))}return(1&r)==1!=((t&tx)===tx)&&(t=n.neg(t)),{x:e,y:t}}if(e===s&&4===r)return{x:n.fromBytes(i.subarray(0,n.BYTES)),y:n.fromBytes(i.subarray(n.BYTES,2*n.BYTES))};throw Error(`Point of length ${e} was invalid. Expected ${o} compressed bytes or ${s} uncompressed bytes`)}}),h=t=>tf.bytesToHex(tf.numberToBytesBE(t,r.nByteLength)),d=(t,e,r)=>tf.bytesToNumberBE(t.slice(e,r));class g{constructor(t,e,r){this.r=t,this.s=e,this.recovery=r,this.assertValidity()}static fromCompact(t){let e=r.nByteLength;return new g(d(t=N("compactSignature",t,2*e),0,e),d(t,e,2*e))}static fromDER(t){let{r:e,s:r}=tp.toSig(N("DER",t));return new g(e,r)}assertValidity(){if(!c(this.r))throw Error("r must be 0 < r < CURVE.n");if(!c(this.s))throw Error("s must be 0 < s < CURVE.n")}addRecoveryBit(t){return new g(this.r,this.s,t)}recoverPublicKey(t){let{r:e,s:o,recovery:s}=this,f=b(N("msgHash",t));if(null==s||![0,1,2,3].includes(s))throw Error("recovery id invalid");let u=2===s||3===s?e+r.n:e;if(u>=n.ORDER)throw Error("recovery id 2 or 3 invalid");let c=(1&s)==0?"02":"03",d=l.fromHex(c+h(u)),g=tt(u,i),y=a(-f*g),p=a(o*g),x=l.BASE.multiplyAndAddUnsafe(d,y,p);if(!x)throw Error("point at infinify");return x.assertValidity(),x}hasHighS(){return this.s>i>>tx}normalizeS(){return this.hasHighS()?new g(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return tf.hexToBytes(this.toDERHex())}toDERHex(){return tp.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return tf.hexToBytes(this.toCompactHex())}toCompactHex(){return h(this.r)+h(this.s)}}function y(t){let e=tf.isBytes(t),r="string"==typeof t,n=(e||r)&&t.length;return e?n===o||n===s:r?n===2*o||n===2*s:t instanceof l}let p=r.bits2int||function(t){let e=tf.bytesToNumberBE(t),n=8*t.length-r.nBitLength;return n>0?e>>BigInt(n):e},b=r.bits2int_modN||function(t){return a(p(t))},x=tf.bitMask(r.nBitLength);function w(t){if("bigint"!=typeof t)throw Error("bigint expected");if(!(tb<=t&&t<x))throw Error(`bigint expected < 2^${r.nBitLength}`);return tf.numberToBytesBE(t,r.nByteLength)}let m={lowS:r.lowS,prehash:!1},E={lowS:r.lowS,prehash:!1};return l.BASE._setWindowSize(8),{CURVE:r,getPublicKey:function(t,e=!0){return l.fromPrivateKey(t).toRawBytes(e)},getSharedSecret:function(t,e,r=!0){if(y(t))throw Error("first arg must be private key");if(!y(e))throw Error("second arg must be public key");return l.fromHex(e).multiply(f(t)).toRawBytes(r)},sign:function(t,e,o=m){let{seed:s,k2sig:u}=function(t,e,o=m){if(["recovered","canonical"].some(t=>t in o))throw Error("sign() legacy options not supported");let{hash:s,randomBytes:u}=r,{lowS:h,prehash:d,extraEntropy:y}=o;null==h&&(h=!0),t=N("msgHash",t),d&&(t=N("prehashed msgHash",s(t)));let x=b(t),E=f(e),A=[w(E),w(x)];if(null!=y&&!1!==y){let t=!0===y?u(n.BYTES):y;A.push(N("extraEntropy",t))}return{seed:tf.concatBytes(...A),k2sig:function(t){var e;let r=p(t);if(!c(r))return;let n=tt(r,i),o=l.BASE.multiply(r).toAffine(),s=a(o.x);if(s===tb)return;let f=a(n*a(x+s*E));if(f===tb)return;let u=2*(o.x!==s)|Number(o.y&tx),d=f;return h&&f>i>>tx&&(d=(e=f)>i>>tx?a(-e):e,u^=1),new g(s,d,u)}}}(t,e,o);return tf.createHmacDrbg(r.hash.outputLen,r.nByteLength,r.hmac)(s,u)},verify:function(t,e,n,o=E){let s,f;if(e=N("msgHash",e),n=N("publicKey",n),"strict"in o)throw Error("options.strict was renamed to lowS");let{lowS:u,prehash:c}=o;try{if("string"==typeof t||tf.isBytes(t))try{f=g.fromDER(t)}catch(e){if(!(e instanceof tp.Err))throw e;f=g.fromCompact(t)}else if("object"==typeof t&&"bigint"==typeof t.r&&"bigint"==typeof t.s){let{r:e,s:r}=t;f=new g(e,r)}else throw Error("PARSE");s=l.fromHex(n)}catch(t){if("PARSE"===t.message)throw Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(u&&f.hasHighS())return!1;c&&(e=r.hash(e));let{r:h,s:d}=f,y=b(e),p=tt(d,i),x=a(y*p),w=a(h*p),m=l.BASE.multiplyAndAddUnsafe(s,x,w)?.toAffine();return!!m&&a(m.x)===h},ProjectivePoint:l,Signature:g,utils:{isValidPrivateKey(t){try{return f(t),!0}catch(t){return!1}},normPrivateKeyToScalar:f,randomPrivateKey:()=>{let t=ta(r.n);return function(t,e,r=!1){let n=t.length,i=ts(e),o=ta(e);if(n<16||n<o||n>1024)throw Error(`expected ${o}-1024 bytes of input, got ${n}`);let s=X(r?O(t):H(t),e-j)+j;return r?T(s,i):L(s,i)}(r.randomBytes(t),r.n)},precompute:(t=8,e=l.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)}}})({...tl,hash:t,hmac:(e,...r)=>p(t,e,c(...r)),randomBytes:g}))(tH),create:e})),tD=function(t,e){if(tn(t),!t.isValid(e.A)||!t.isValid(e.B)||!t.isValid(e.Z))throw Error("mapToCurveSimpleSWU: invalid opts");let r=function(t,e){let r=t.ORDER,n=tb;for(let t=r-tx;t%tw===tb;t/=tw)n+=tx;let i=n,o=tw<<i-tx-tx,s=o*tw,a=(r-tx)/s,l=(a-tx)/tw,f=s-tx,u=t.pow(e,a),c=t.pow(e,(a+tx)/tw),h=(e,r)=>{let n=u,s=t.pow(r,f),a=t.sqr(s);a=t.mul(a,r);let h=t.mul(e,a);h=t.pow(h,l),h=t.mul(h,s),s=t.mul(h,r),a=t.mul(h,e);let d=t.mul(a,s);h=t.pow(d,o);let g=t.eql(h,t.ONE);s=t.mul(a,c),h=t.mul(d,n),a=t.cmov(s,a,g),d=t.cmov(h,d,g);for(let e=i;e>tx;e--){let r=e-tw;r=tw<<r-tx;let i=t.pow(d,r),o=t.eql(i,t.ONE);s=t.mul(a,n),n=t.mul(n,n),i=t.mul(d,n),a=t.cmov(s,a,o),d=t.cmov(i,d,o)}return{isValid:g,value:a}};if(t.ORDER%tE===tm){let r=(t.ORDER-tm)/tE,n=t.sqrt(t.neg(e));h=(e,i)=>{let o=t.sqr(i),s=t.mul(e,i);o=t.mul(o,s);let a=t.pow(o,r);a=t.mul(a,s);let l=t.mul(a,n),f=t.mul(t.sqr(a),i),u=t.eql(f,e),c=t.cmov(l,a,u);return{isValid:u,value:c}}}return h}(t,e.Z);if(!t.isOdd)throw Error("Fp.isOdd is not implemented!");return n=>{let i,o,s,a,l,f,u,c;i=t.sqr(n),i=t.mul(i,e.Z),o=t.sqr(i),o=t.add(o,i),s=t.add(o,t.ONE),s=t.mul(s,e.B),a=t.cmov(e.Z,t.neg(o),!t.eql(o,t.ZERO)),a=t.mul(a,e.A),o=t.sqr(s),f=t.sqr(a),l=t.mul(f,e.A),o=t.add(o,l),o=t.mul(o,s),f=t.mul(f,a),l=t.mul(f,e.B),o=t.add(o,l),u=t.mul(i,s);let{isValid:h,value:d}=r(o,f);c=t.mul(i,n),c=t.mul(c,d),u=t.cmov(u,s,h),c=t.cmov(c,d,h);let g=t.isOdd(n)===t.isOdd(c);return c=t.cmov(t.neg(c),c,g),{x:u=t.div(u,a),y:c}}}(tq,{A:t$,B:tP,Z:tq.create(BigInt("-10"))});tN(tz.ProjectivePoint,t=>tD(t[0]),{DST:"P256_XMD:SHA-256_SSWU_RO_",encodeDST:"P256_XMD:SHA-256_SSWU_NU_",p:tq.ORDER,m:1,k:128,expand:"xmd",hash:tH});let tF=new Uint8Array([0]),tk=new Uint8Array;function tC(t){return t instanceof Uint8Array||null!=t&&"object"==typeof t&&"Uint8Array"===t.constructor.name}function t_(t,...e){if(!tC(t))throw Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function tM(t,e=!0){if(t.destroyed)throw Error("Hash instance has been destroyed");if(e&&t.finished)throw Error("Hash#digest() has already been called")}function tV(t,e){t_(t);let r=e.outputLen;if(t.length<r)throw Error(`digestInto() expects output buffer of length at least ${r}`)}let tZ=t=>new Uint8Array(t.buffer,t.byteOffset,t.byteLength),tj=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),tK=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);if(68!==new Uint8Array(new Uint32Array([0x11223344]).buffer)[0])throw Error("Non little-endian hardware is not supported");function tG(t){if("string"==typeof t)t=function(t){if("string"!=typeof t)throw Error(`string expected, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}(t);else if(tC(t))t=t.slice();else throw Error(`Uint8Array expected, got ${typeof t}`);return t}function tW(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return 0===r}let tY=(t,e)=>(Object.assign(e,t),e);function tJ(t,e,r,n){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,r,n);let i=BigInt(32),o=BigInt(0xffffffff),s=Number(r>>i&o),a=Number(r&o),l=4*!!n,f=4*!n;t.setUint32(e+l,s,n),t.setUint32(e+f,a,n)}let tX=new Uint8Array(16),tQ=tj(tX),t0=(t,e,r,n)=>({s3:r<<31|n>>>1,s2:e<<31|r>>>1,s1:t<<31|e>>>1,s0:t>>>1^-0x1f000000&-(1&n&1)}),t1=t=>(t>>>0&255)<<24|(t>>>8&255)<<16|(t>>>16&255)<<8|t>>>24&255;class t2{constructor(t,e){this.blockLen=16,this.outputLen=16,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,t_(t=tG(t),16);const r=tK(t);let n=r.getUint32(0,!1),i=r.getUint32(4,!1),o=r.getUint32(8,!1),s=r.getUint32(12,!1);const a=[];for(let t=0;t<128;t++)a.push({s0:t1(n),s1:t1(i),s2:t1(o),s3:t1(s)}),{s0:n,s1:i,s2:o,s3:s}=t0(n,i,o,s);const l=(t=>t>65536?8:t>1024?4:2)(e||1024);if(![1,2,4,8].includes(l))throw Error(`ghash: wrong window size=${l}, should be 2, 4 or 8`);this.W=l;const f=128/l,u=this.windowSize=2**l,c=[];for(let t=0;t<f;t++)for(let e=0;e<u;e++){let r=0,n=0,i=0,o=0;for(let s=0;s<l;s++){if(!(e>>>l-s-1&1))continue;const{s0:f,s1:u,s2:c,s3:h}=a[l*t+s];r^=f,n^=u,i^=c,o^=h}c.push({s0:r,s1:n,s2:i,s3:o})}this.t=c}_updateBlock(t,e,r,n){t^=this.s0,e^=this.s1,r^=this.s2,n^=this.s3;let{W:i,t:o,windowSize:s}=this,a=0,l=0,f=0,u=0,c=(1<<i)-1,h=0;for(let d of[t,e,r,n])for(let t=0;t<4;t++){let e=d>>>8*t&255;for(let t=8/i-1;t>=0;t--){let{s0:r,s1:n,s2:d,s3:g}=o[h*s+(e>>>i*t&c)];a^=r,l^=n,f^=d,u^=g,h+=1}}this.s0=a,this.s1=l,this.s2=f,this.s3=u}update(t){t=tG(t),tM(this);let e=tj(t),r=Math.floor(t.length/16),n=t.length%16;for(let t=0;t<r;t++)this._updateBlock(e[4*t+0],e[4*t+1],e[4*t+2],e[4*t+3]);return n&&(tX.set(t.subarray(16*r)),this._updateBlock(tQ[0],tQ[1],tQ[2],tQ[3]),tQ.fill(0)),this}destroy(){let{t}=this;for(let e of t)e.s0=0,e.s1=0,e.s2=0,e.s3=0}digestInto(t){tM(this),tV(t,this),this.finished=!0;let{s0:e,s1:r,s2:n,s3:i}=this,o=tj(t);return o[0]=e,o[1]=r,o[2]=n,o[3]=i,t}digest(){let t=new Uint8Array(16);return this.digestInto(t),this.destroy(),t}}class t8 extends t2{constructor(t,e){const r=function(t){t.reverse();let e=1&t[15],r=0;for(let e=0;e<t.length;e++){let n=t[e];t[e]=n>>>1|r,r=(1&n)<<7}return t[0]^=225&-e,t}((t=tG(t)).slice());super(r,e),r.fill(0)}update(t){t=tG(t),tM(this);let e=tj(t),r=t.length%16,n=Math.floor(t.length/16);for(let t=0;t<n;t++)this._updateBlock(t1(e[4*t+3]),t1(e[4*t+2]),t1(e[4*t+1]),t1(e[4*t+0]));return r&&(tX.set(t.subarray(16*n)),this._updateBlock(t1(tQ[3]),t1(tQ[2]),t1(tQ[1]),t1(tQ[0])),tQ.fill(0)),this}digestInto(t){tM(this),tV(t,this),this.finished=!0;let{s0:e,s1:r,s2:n,s3:i}=this,o=tj(t);return o[0]=e,o[1]=r,o[2]=n,o[3]=i,t.reverse()}}function t3(t){let e=(e,r)=>t(r,e.length).update(tG(e)).digest(),r=t(new Uint8Array(16),0);return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=(e,r)=>t(e,r),e}let t5=t3((t,e)=>new t2(t,e)),t6=t3((t,e)=>new t8(t,e)),t4=new Uint8Array(16);function t7(t){return t<<1^283&-(t>>7)}function t9(t,e){let r=0;for(;e>0;e>>=1)r^=t&-(1&e),t=t7(t);return r}let et=(()=>{let t=new Uint8Array(256);for(let e=0,r=1;e<256;e++,r^=t7(r))t[e]=r;let e=new Uint8Array(256);e[0]=99;for(let r=0;r<255;r++){let n=t[255-r];n|=n<<8,e[t[r]]=(n^n>>4^n>>5^n>>6^n>>7^99)&255}return e})(),ee=et.map((t,e)=>et.indexOf(e)),er=t=>t<<24|t>>>8,en=t=>t<<8|t>>>24;function ei(t,e){if(256!==t.length)throw Error("Wrong sbox length");let r=new Uint32Array(256).map((r,n)=>e(t[n])),n=r.map(en),i=n.map(en),o=i.map(en),s=new Uint32Array(65536),a=new Uint32Array(65536),l=new Uint16Array(65536);for(let e=0;e<256;e++)for(let f=0;f<256;f++){let u=256*e+f;s[u]=r[e]^n[f],a[u]=i[e]^o[f],l[u]=t[e]<<8|t[f]}return{sbox:t,sbox2:l,T0:r,T1:n,T2:i,T3:o,T01:s,T23:a}}let eo=ei(et,t=>t9(t,3)<<24|t<<16|t<<8|t9(t,2)),es=ei(ee,t=>t9(t,11)<<24|t9(t,13)<<16|t9(t,9)<<8|t9(t,14)),ea=(()=>{let t=new Uint8Array(16);for(let e=0,r=1;e<16;e++,r=t7(r))t[e]=r;return t})();function el(t){t_(t);let e=t.length;if(![16,24,32].includes(e))throw Error(`aes: wrong key size: should be 16, 24 or 32, got: ${e}`);let{sbox2:r}=eo,n=tj(t),i=n.length,o=t=>ec(r,t,t,t,t),s=new Uint32Array(e+28);s.set(n);for(let t=i;t<s.length;t++){let e=s[t-1];t%i==0?e=o(er(e))^ea[t/i-1]:i>6&&t%i==4&&(e=o(e)),s[t]=s[t-i]^e}return s}function ef(t){let e=el(t),r=e.slice(),n=e.length,{sbox2:i}=eo,{T0:o,T1:s,T2:a,T3:l}=es;for(let t=0;t<n;t+=4)for(let i=0;i<4;i++)r[t+i]=e[n-t-4+i];e.fill(0);for(let t=4;t<n-4;t++){let e=r[t],n=ec(i,e,e,e,e);r[t]=o[255&n]^s[n>>>8&255]^a[n>>>16&255]^l[n>>>24]}return r}function eu(t,e,r,n,i,o){return t[r<<8&65280|n>>>8&255]^e[i>>>8&65280|o>>>24&255]}function ec(t,e,r,n,i){return t[255&e|65280&r]|t[n>>>16&255|i>>>16&65280]<<16}function eh(t,e,r,n,i){let{sbox2:o,T01:s,T23:a}=eo,l=0;e^=t[l++],r^=t[l++],n^=t[l++],i^=t[l++];let f=t.length/4-2;for(let o=0;o<f;o++){let o=t[l++]^eu(s,a,e,r,n,i),f=t[l++]^eu(s,a,r,n,i,e),u=t[l++]^eu(s,a,n,i,e,r),c=t[l++]^eu(s,a,i,e,r,n);e=o,r=f,n=u,i=c}return{s0:t[l++]^ec(o,e,r,n,i),s1:t[l++]^ec(o,r,n,i,e),s2:t[l++]^ec(o,n,i,e,r),s3:t[l++]^ec(o,i,e,r,n)}}function ed(t,e,r,n,i){let{sbox2:o,T01:s,T23:a}=es,l=0;e^=t[l++],r^=t[l++],n^=t[l++],i^=t[l++];let f=t.length/4-2;for(let o=0;o<f;o++){let o=t[l++]^eu(s,a,e,i,n,r),f=t[l++]^eu(s,a,r,e,i,n),u=t[l++]^eu(s,a,n,r,e,i),c=t[l++]^eu(s,a,i,n,r,e);e=o,r=f,n=u,i=c}return{s0:t[l++]^ec(o,e,i,n,r),s1:t[l++]^ec(o,r,e,i,n),s2:t[l++]^ec(o,n,r,e,i),s3:t[l++]^ec(o,i,n,r,e)}}function eg(t,e){if(!e)return new Uint8Array(t);if(t_(e),e.length<t)throw Error(`aes: wrong destination length, expected at least ${t}, got: ${e.length}`);return e}function ey(t,e,r,n,i){t_(r,16),t_(n),i=eg(n.length,i);let o=tj(r),s=tK(r),a=tj(n),l=tj(i),f=12*!e,u=n.length,c=s.getUint32(f,e),{s0:h,s1:d,s2:g,s3:y}=eh(t,o[0],o[1],o[2],o[3]);for(let r=0;r+4<=a.length;r+=4)l[r+0]=a[r+0]^h,l[r+1]=a[r+1]^d,l[r+2]=a[r+2]^g,l[r+3]=a[r+3]^y,c=c+1>>>0,s.setUint32(f,c,e),{s0:h,s1:d,s2:g,s3:y}=eh(t,o[0],o[1],o[2],o[3]);let p=16*Math.floor(a.length/4);if(p<u){let t=tZ(new Uint32Array([h,d,g,y]));for(let e=p,r=0;e<u;e++,r++)i[e]=n[e]^t[r]}return i}function ep(t){if(t_(t),t.length%16!=0)throw Error("aes/(cbc-ecb).decrypt ciphertext should consist of blocks with size 16")}function eb(t,e,r){let n=t.length,i=n%16;if(!e&&0!==i)throw Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");let o=tj(t);if(e){let t=16-i;t||(t=16),n+=t}let s=eg(n,r);return{b:o,o:tj(s),out:s}}function ex(t,e){if(!e)return t;let r=t.length;if(!r)throw Error("aes/pcks5: empty ciphertext not allowed");let n=t[r-1];if(n<=0||n>16)throw Error(`aes/pcks5: wrong padding byte: ${n}`);let i=t.subarray(0,-n);for(let e=0;e<n;e++)if(t[r-e-1]!==n)throw Error("aes/pcks5: wrong padding");return i}function ew(t){let e=new Uint8Array(16),r=tj(e);e.set(t);let n=16-t.length;for(let t=16-n;t<16;t++)e[t]=n;return r}function em(t,e,r,n,i){let o=t.create(r,n.length+(i?.length||0));i&&o.update(i),o.update(n);let s=new Uint8Array(16),a=tK(s);return i&&tJ(a,0,BigInt(8*i.length),e),tJ(a,8,BigInt(8*n.length),e),o.update(s),o.digest()}tY({blockSize:16,nonceLength:16},function(t,e){function r(r,n){let i=el(t),o=e.slice(),s=function(t,e,r,n){t_(e,16),t_(r);let i=r.length;n=eg(i,n);let o=tj(e),{s0:s,s1:a,s2:l,s3:f}=eh(t,o[0],o[1],o[2],o[3]),u=tj(r),c=tj(n);for(let r=0;r+4<=u.length;r+=4){c[r+0]=u[r+0]^s,c[r+1]=u[r+1]^a,c[r+2]=u[r+2]^l,c[r+3]=u[r+3]^f;let n=1;for(let t=e.length-1;t>=0;t--)n=n+(255&e[t])|0,e[t]=255&n,n>>>=8;({s0:s,s1:a,s2:l,s3:f}=eh(t,o[0],o[1],o[2],o[3]))}let h=16*Math.floor(u.length/4);if(h<i){let t=tZ(new Uint32Array([s,a,l,f]));for(let e=h,o=0;e<i;e++,o++)n[e]=r[e]^t[o]}return n}(i,o,r,n);return i.fill(0),o.fill(0),s}return t_(t),t_(e,16),{encrypt:(t,e)=>r(t,e),decrypt:(t,e)=>r(t,e)}}),tY({blockSize:16},function(t,e={}){t_(t);let r=!e.disablePadding;return{encrypt:(e,n)=>{t_(e);let{b:i,o,out:s}=eb(e,r,n),a=el(t),l=0;for(;l+4<=i.length;){let{s0:t,s1:e,s2:r,s3:n}=eh(a,i[l+0],i[l+1],i[l+2],i[l+3]);o[l++]=t,o[l++]=e,o[l++]=r,o[l++]=n}if(r){let t=ew(e.subarray(4*l)),{s0:r,s1:n,s2:i,s3:s}=eh(a,t[0],t[1],t[2],t[3]);o[l++]=r,o[l++]=n,o[l++]=i,o[l++]=s}return a.fill(0),s},decrypt:(e,n)=>{ep(e);let i=ef(t),o=eg(e.length,n),s=tj(e),a=tj(o);for(let t=0;t+4<=s.length;){let{s0:e,s1:r,s2:n,s3:o}=ed(i,s[t+0],s[t+1],s[t+2],s[t+3]);a[t++]=e,a[t++]=r,a[t++]=n,a[t++]=o}return i.fill(0),ex(o,r)}}}),tY({blockSize:16,nonceLength:16},function(t,e,r={}){t_(t),t_(e,16);let n=!r.disablePadding;return{encrypt:(r,i)=>{let o=el(t),{b:s,o:a,out:l}=eb(r,n,i),f=tj(e),u=f[0],c=f[1],h=f[2],d=f[3],g=0;for(;g+4<=s.length;)u^=s[g+0],c^=s[g+1],h^=s[g+2],d^=s[g+3],({s0:u,s1:c,s2:h,s3:d}=eh(o,u,c,h,d)),a[g++]=u,a[g++]=c,a[g++]=h,a[g++]=d;if(n){let t=ew(r.subarray(4*g));u^=t[0],c^=t[1],h^=t[2],d^=t[3],({s0:u,s1:c,s2:h,s3:d}=eh(o,u,c,h,d)),a[g++]=u,a[g++]=c,a[g++]=h,a[g++]=d}return o.fill(0),l},decrypt:(r,i)=>{ep(r);let o=ef(t),s=tj(e),a=eg(r.length,i),l=tj(r),f=tj(a),u=s[0],c=s[1],h=s[2],d=s[3];for(let t=0;t+4<=l.length;){let e=u,r=c,n=h,i=d;u=l[t+0],c=l[t+1];let{s0:s,s1:a,s2:g,s3:y}=ed(o,u,c,h=l[t+2],d=l[t+3]);f[t++]=s^e,f[t++]=a^r,f[t++]=g^n,f[t++]=y^i}return o.fill(0),ex(a,n)}}}),tY({blockSize:16,nonceLength:16},function(t,e){function r(r,n,i){let o=el(t),s=r.length;i=eg(s,i);let a=tj(r),l=tj(i),f=n?l:a,u=tj(e),c=u[0],h=u[1],d=u[2],g=u[3];for(let t=0;t+4<=a.length;){let{s0:e,s1:r,s2:n,s3:i}=eh(o,c,h,d,g);l[t+0]=a[t+0]^e,l[t+1]=a[t+1]^r,l[t+2]=a[t+2]^n,l[t+3]=a[t+3]^i,c=f[t++],h=f[t++],d=f[t++],g=f[t++]}let y=16*Math.floor(a.length/4);if(y<s){({s0:c,s1:h,s2:d,s3:g}=eh(o,c,h,d,g));let t=tZ(new Uint32Array([c,h,d,g]));for(let e=y,n=0;e<s;e++,n++)i[e]=r[e]^t[n];t.fill(0)}return o.fill(0),i}return t_(t),t_(e,16),{encrypt:(t,e)=>r(t,!0,e),decrypt:(t,e)=>r(t,!1,e)}});let eE=tY({blockSize:16,nonceLength:12,tagLength:16},function(t,e,r){if(t_(e),0===e.length)throw Error("aes/gcm: empty nonce");function n(t,e,n){let i=em(t5,!1,t,n,r);for(let t=0;t<e.length;t++)i[t]^=e[t];return i}function i(){let r=el(t),n=t4.slice(),i=t4.slice();if(ey(r,!1,i,i,n),12===e.length)i.set(e);else{let t=t4.slice();tJ(tK(t),8,BigInt(8*e.length),!1),t5.create(n).update(e).update(t).digestInto(i)}let o=ey(r,!1,i,t4);return{xk:r,authKey:n,counter:i,tagMask:o}}return{encrypt:t=>{t_(t);let{xk:e,authKey:r,counter:o,tagMask:s}=i(),a=new Uint8Array(t.length+16);ey(e,!1,o,t,a);let l=n(r,s,a.subarray(0,a.length-16));return a.set(l,t.length),e.fill(0),a},decrypt:t=>{if(t_(t),t.length<16)throw Error("aes/gcm: ciphertext less than tagLen (16)");let{xk:e,authKey:r,counter:o,tagMask:s}=i(),a=t.subarray(0,-16),l=t.subarray(-16);if(!tW(n(r,s,a),l))throw Error("aes/gcm: invalid ghash tag");let f=ey(e,!1,o,a);return r.fill(0),s.fill(0),e.fill(0),f}}}),eA=(t,e,r)=>n=>{if(!Number.isSafeInteger(n)||e>n||n>r)throw Error(`${t}: invalid value=${n}, must be [${e}..${r}]`)};tY({blockSize:16,nonceLength:12,tagLength:16},function(t,e,r){let n=eA("AAD",0,0x1000000000),i=eA("plaintext",0,0x1000000000),o=eA("nonce",12,12),s=eA("ciphertext",16,0x1000000000+16);function a(){let r=t.length;if(16!==r&&24!==r&&32!==r)throw Error(`key length must be 16, 24 or 32 bytes, got: ${r} bytes`);let n=el(t),i=new Uint8Array(r),o=new Uint8Array(16),s=tj(e),a=0,l=s[0],f=s[1],u=s[2],c=0;for(let t of[o,i].map(tj)){let e=tj(t);for(let t=0;t<e.length;t+=2){let{s0:r,s1:i}=eh(n,a,l,f,u);e[t+0]=r,e[t+1]=i,a=++c}}return n.fill(0),{authKey:o,encKey:el(i)}}function l(t,n,i){let o=em(t6,!0,n,i,r);for(let t=0;t<12;t++)o[t]^=e[t];o[15]&=127;let s=tj(o),a=s[0],l=s[1],f=s[2],u=s[3];return{s0:a,s1:l,s2:f,s3:u}=eh(t,a,l,f,u),s[0]=a,s[1]=l,s[2]=f,s[3]=u,o}function f(t,e,r){let n=e.slice();return n[15]|=128,ey(t,!0,n,r)}return t_(e),o(e.length),r&&(t_(r),n(r.length)),{encrypt:t=>{t_(t),i(t.length);let{encKey:e,authKey:r}=a(),n=l(e,r,t),o=new Uint8Array(t.length+16);return o.set(n,t.length),o.set(f(e,n,t)),e.fill(0),r.fill(0),o},decrypt:t=>{t_(t),s(t.length);let e=t.subarray(-16),{encKey:r,authKey:n}=a(),i=f(r,e,t.subarray(0,-16)),o=l(r,n,i);if(r.fill(0),n.fill(0),!tW(e,o))throw Error("invalid polyval tag");return i}}});var eB=t.i(110831);let ev=(t,e)=>(t&BigInt(1)<<BigInt(e))!==BigInt(0),eS=new Uint8Array([75,69,77,0,16]),eU=new Uint8Array([72,80,75,69,0,16,0,1,0,2]),eI=new Uint8Array([72,80,75,69,45,118,49]),eO=new Uint8Array([115,101,99,114,101,116]),eH=new Uint8Array([101,97,101,95,112,114,107]),eL=new Uint8Array([115,104,97,114,101,100,95,115,101,99,114,101,116]),eT=new Uint8Array([0,32,72,80,75,69,45,118,49,72,80,75,69,0,16,0,1,0,2,107,101,121,0,143,195,174,184,50,73,10,75,90,179,228,32,35,40,125,178,154,31,75,199,194,34,192,223,34,135,39,183,10,64,33,18,47,63,4,233,32,108,209,36,19,80,53,41,180,122,198,166,48,185,46,196,207,125,35,69,8,208,175,151,113,201,158,80]),eR=new Uint8Array([0,12,72,80,75,69,45,118,49,72,80,75,69,0,16,0,1,0,2,98,97,115,101,95,110,111,110,99,101,0,143,195,174,184,50,73,10,75,90,179,228,32,35,40,125,178,154,31,75,199,194,34,192,223,34,135,39,183,10,64,33,18,47,63,4,233,32,108,209,36,19,80,53,41,180,122,198,166,48,185,46,196,207,125,35,69,8,208,175,151,113,201,158,80]),eN="04cf288fe433cc4e1aa0ce1632feac4ea26bf2f5a09dcfe5a42c398e06898710330f0572882f4dbdf0f5304b8fc8703acd69adca9a4bbf7f5d00d20a5e364b2569",eq=(t,e=!0)=>tz.getPublicKey(t,e),e$=({plainTextBuf:t,targetKeyBuf:e})=>{try{let r=eF(),n=(0,eB.uint8ArrayFromHexString)(r.privateKey),i=(0,eB.uint8ArrayFromHexString)(r.publicKeyUncompressed),o=ek(i,e),s=eK(e,(0,eB.uint8ArrayToHexString)(n)),a=eY(i,(0,eB.uint8ArrayToHexString)(e)),l=eV(eH,s,eS),f=eZ(eL,a,eS,32),u=ej(new Uint8Array([]),l,f,32);l=eV(eO,new Uint8Array([]),eU),f=eT;let c=ej(u,l,f,32);f=eR;let h=ej(u,l,f,12),d=eG(t,c,h,o),g=e_(i),y=new Uint8Array(g.length+d.length);return y.set(g,0),y.set(d,g.length),y}catch(t){throw Error(`Unable to perform hpkeEncrypt: ${t}`)}},eP=({plainTextBuf:t,targetKeyBuf:e,senderPriv:r})=>{try{let n=(0,eB.uint8ArrayFromHexString)(r),i=eq(r,!1),o=ek(i,e),s=eK(e,(0,eB.uint8ArrayToHexString)(n)),a=eY(i,(0,eB.uint8ArrayToHexString)(e)),l=eV(eH,s,eS),f=eZ(eL,a,eS,32),u=ej(new Uint8Array([]),l,f,32);l=eV(eO,new Uint8Array([]),eU),f=eT;let c=ej(u,l,f,32);f=eR;let h=ej(u,l,f,12),d=eG(t,c,h,o),g=e_(i),y=new Uint8Array(g.length+d.length);return y.set(g,0),y.set(d,g.length),y}catch(t){throw Error(`Unable to perform hpkeEncrypt: ${t}`)}},ez=t=>{let e=t.slice(0,33),r=t.slice(33);return JSON.stringify({encappedPublic:(0,eB.uint8ArrayToHexString)(eM(e)),ciphertext:(0,eB.uint8ArrayToHexString)(r)})},eD=({ciphertextBuf:t,encappedKeyBuf:e,receiverPriv:r})=>{try{let n,i,o=eq((0,eB.uint8ArrayFromHexString)(r),!1),s=ek(e,o),a=eK(e,r),l=eY(e,(0,eB.uint8ArrayToHexString)(o));n=eV(eH,a,eS),i=eZ(eL,l,eS,32);let f=ej(new Uint8Array([]),n,i,32);n=eV(eO,new Uint8Array([]),eU),i=eT;let u=ej(f,n,i,32);i=eR;let c=ej(f,n,i,12);return eW(t,u,c,s)}catch(t){throw Error(`Unable to perform hpkeDecrypt: ${t} `)}},eF=()=>{let t=g(32),e=eq(t,!0),r=(0,eB.uint8ArrayToHexString)(eM(e));return{privateKey:(0,eB.uint8ArrayToHexString)(t),publicKey:(0,eB.uint8ArrayToHexString)(e),publicKeyUncompressed:r}},ek=(t,e)=>new Uint8Array([...Array.from(t),...Array.from(e)]),eC=t=>t.slice(36,68),e_=t=>{let e=t.byteLength;var r=t.slice(0,1+e>>>1);return r[0]=2|1&t[e-1],r},eM=t=>{let e=3===t[0],r=BigInt("0x"+(0,eB.uint8ArrayToHexString)(t.subarray(1))),n=BigInt("115792089210356248762697446949407573530086143415290314195533631308867097853951"),i=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b "),o=((t,e)=>{if(e<=BigInt(0))throw Error("p must be positive");let r=t%e;if(ev(e,0)&&ev(e,1)){let t=((t,e,r)=>{if(e===BigInt(0))return BigInt(1);let n=t%r,i=e.toString(2);for(let e=1;e<i.length;++e)n=n*n%r,"1"===i[e]&&(n=n*t%r);return n})(r,e+BigInt(1)>>BigInt(2),e);if(t*t%e!==r)throw Error("could not find a modular square root");return t}throw Error("unsupported modulus value")})(((r*r+(n-BigInt(3)))*r+i)%n,n);if(e!==ev(o,0)&&(o=(n-o)%n),r<BigInt(0)||r>=n)throw Error("x is out of range");if(o<BigInt(0)||o>=n)throw Error("y is out of range");var s="04"+eJ(r,64)+eJ(o,64);return(0,eB.uint8ArrayFromHexString)(s)},eV=(t,e,r)=>{let n=new Uint8Array(eI.length+r.length+t.length+e.length),i=0;return n.set(eI,i),i+=eI.length,n.set(r,i),i+=r.length,n.set(t,i),i+=t.length,n.set(e,i),n},eZ=(t,e,r,n)=>{let i=new Uint8Array(9+r.byteLength+t.byteLength+e.byteLength);return i.set(new Uint8Array([0,n]),0),i.set(eI,2),i.set(r,9),i.set(t,9+r.byteLength),i.set(e,9+r.byteLength+t.byteLength),i},ej=(t,e,n,o)=>{var s;let a=(s=t,i(tH),void 0===s&&(s=new Uint8Array(tH.outputLen)),p(tH,u(s),u(e))),l=function(t,e,n,o=32){if(i(t),r(o),o>255*t.outputLen)throw Error("Length should be <= 255*HashLen");let s=Math.ceil(o/t.outputLen);void 0===n&&(n=tk);let a=new Uint8Array(s*t.outputLen),l=p.create(t,e),f=l._cloneInto(),u=new Uint8Array(l.outputLen);for(let e=0;e<s;e++)tF[0]=e+1,f.update(0===e?tk:u).update(n).update(tF).digestInto(u),a.set(u,t.outputLen*e),l._cloneInto(f);return l.destroy(),f.destroy(),u.fill(0),tF.fill(0),a.slice(0,o)}(tH,a,n,o);return new Uint8Array(l)},eK=(t,e)=>tz.getSharedSecret((0,eB.uint8ArrayFromHexString)(e),t).slice(1),eG=(t,e,r,n)=>eE(e,r,n).encrypt(t),eW=(t,e,r,n)=>eE(e,r,n).decrypt(t),eY=(t,e)=>{let r=new Uint8Array(t),n=(0,eB.uint8ArrayFromHexString)(e),i=new Uint8Array(r.length+n.length);return i.set(r),i.set(n,r.length),i},eJ=(t,e)=>{let r=t.toString(16);if(r.length>e)throw Error(`number cannot fit in a hex string of ${e} characters`);return r.padStart(e,"0")},eX=t=>{let e=(0,eB.uint8ArrayFromHexString)(t),r=2;if(2!==e[2])throw Error("failed to convert DER-encoded signature: invalid tag for r");let n=e[++r];r++;let i=e.slice(r,r+n);if(2!==e[r+=n])throw Error("failed to convert DER-encoded signature: invalid tag for s");let o=e[++r];r++;let s=e.slice(r,r+o);return new Uint8Array([...(0,eB.normalizePadding)(i,32),...(0,eB.normalizePadding)(s,32)])},eQ=t=>{let e=(0,eB.uint8ArrayFromHexString)(t),r=e.slice(0,32),n=e.slice(32,64),i=t=>{if(void 0===t||0===t.length||void 0===t[0])throw Error("Invalid integer: input is undefined or empty.");let e=128&t[0]?new Uint8Array([0,...t]):t;return new Uint8Array([2,e.length,...e])},o=i(r),s=i(n),a=new Uint8Array([48,o.length+s.length,...o,...s]);return(0,eB.uint8ArrayToHexString)(a)};t.s(["buildAdditionalAssociatedData",()=>ek,"compressRawPublicKey",()=>e_,"extractPrivateKeyFromPKCS8Bytes",()=>eC,"formatHpkeBuf",()=>ez,"fromDerSignature",()=>eX,"generateP256KeyPair",()=>eF,"getPublicKey",()=>eq,"hpkeAuthEncrypt",()=>eP,"hpkeDecrypt",()=>eD,"hpkeEncrypt",()=>e$,"toDerSignature",()=>eQ,"uncompressRawPublicKey",()=>eM],356026);var e0=t.i(666826),e1=t.i(683856);let e2=BigInt(0x100000000-1),e8=BigInt(32),e3=(t,e,r)=>t>>>r,e5=(t,e,r)=>t<<32-r|e>>>r,e6=(t,e,r)=>t>>>r|e<<32-r,e4=(t,e,r)=>t<<32-r|e>>>r,e7=(t,e,r)=>t<<64-r|e>>>r-32,e9=(t,e,r)=>t>>>r-32|e<<64-r,rt=function(t,e,r,n){let i=(e>>>0)+(n>>>0);return{h:t+r+(i/0x100000000|0)|0,l:0|i}},re=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),rr=(t,e,r,n)=>e+r+n+(t/0x100000000|0)|0,rn=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),ri=(t,e,r,n,i)=>e+r+n+i+(t/0x100000000|0)|0,ro=(t,e,r,n,i,o)=>e+r+n+i+o+(t/0x100000000|0)|0,rs=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),[ra,rl]=function(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){let{h:o,l:s}=function(t,e=!1){return e?{h:Number(t&e2),l:Number(t>>e8&e2)}:{h:0|Number(t>>e8&e2),l:0|Number(t&e2)}}(t[i],e);[r[i],n[i]]=[o,s]}return[r,n]}(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),rf=new Uint32Array(80),ru=new Uint32Array(80);class rc extends tv{constructor(){super(128,64,16,!1),this.Ah=0x6a09e667,this.Al=-0xc4336f8,this.Bh=-0x4498517b,this.Bl=-0x7b3558c5,this.Ch=0x3c6ef372,this.Cl=-0x16b07d5,this.Dh=-0x5ab00ac6,this.Dl=0x5f1d36f1,this.Eh=0x510e527f,this.El=-0x52197d2f,this.Fh=-0x64fa9774,this.Fl=0x2b3e6c1f,this.Gh=0x1f83d9ab,this.Gl=-0x4be4295,this.Hh=0x5be0cd19,this.Hl=0x137e2179}get(){let{Ah:t,Al:e,Bh:r,Bl:n,Ch:i,Cl:o,Dh:s,Dl:a,Eh:l,El:f,Fh:u,Fl:c,Gh:h,Gl:d,Hh:g,Hl:y}=this;return[t,e,r,n,i,o,s,a,l,f,u,c,h,d,g,y]}set(t,e,r,n,i,o,s,a,l,f,u,c,h,d,g,y){this.Ah=0|t,this.Al=0|e,this.Bh=0|r,this.Bl=0|n,this.Ch=0|i,this.Cl=0|o,this.Dh=0|s,this.Dl=0|a,this.Eh=0|l,this.El=0|f,this.Fh=0|u,this.Fl=0|c,this.Gh=0|h,this.Gl=0|d,this.Hh=0|g,this.Hl=0|y}process(t,e){for(let r=0;r<16;r++,e+=4)rf[r]=t.getUint32(e),ru[r]=t.getUint32(e+=4);for(let t=16;t<80;t++){let e=0|rf[t-15],r=0|ru[t-15],n=e6(e,r,1)^e6(e,r,8)^e3(e,r,7),i=e4(e,r,1)^e4(e,r,8)^e5(e,r,7),o=0|rf[t-2],s=0|ru[t-2],a=e6(o,s,19)^e7(o,s,61)^e3(o,s,6),l=rn(i,e4(o,s,19)^e9(o,s,61)^e5(o,s,6),ru[t-7],ru[t-16]),f=ri(l,n,a,rf[t-7],rf[t-16]);rf[t]=0|f,ru[t]=0|l}let{Ah:r,Al:n,Bh:i,Bl:o,Ch:s,Cl:a,Dh:l,Dl:f,Eh:u,El:c,Fh:h,Fl:d,Gh:g,Gl:y,Hh:p,Hl:b}=this;for(let t=0;t<80;t++){let e=e6(u,c,14)^e6(u,c,18)^e7(u,c,41),x=e4(u,c,14)^e4(u,c,18)^e9(u,c,41),w=u&h^~u&g,m=rs(b,x,c&d^~c&y,rl[t],ru[t]),E=ro(m,p,e,w,ra[t],rf[t]),A=0|m,B=e6(r,n,28)^e7(r,n,34)^e7(r,n,39),v=e4(r,n,28)^e9(r,n,34)^e9(r,n,39),S=r&i^r&s^i&s,U=n&o^n&a^o&a;p=0|g,b=0|y,g=0|h,y=0|d,h=0|u,d=0|c,({h:u,l:c}=rt(0|l,0|f,0|E,0|A)),l=0|s,f=0|a,s=0|i,a=0|o,i=0|r,o=0|n;let I=re(A,v,U);r=rr(I,E,B,S),n=0|I}({h:r,l:n}=rt(0|this.Ah,0|this.Al,0|r,0|n)),({h:i,l:o}=rt(0|this.Bh,0|this.Bl,0|i,0|o)),({h:s,l:a}=rt(0|this.Ch,0|this.Cl,0|s,0|a)),({h:l,l:f}=rt(0|this.Dh,0|this.Dl,0|l,0|f)),({h:u,l:c}=rt(0|this.Eh,0|this.El,0|u,0|c)),({h:h,l:d}=rt(0|this.Fh,0|this.Fl,0|h,0|d)),({h:g,l:y}=rt(0|this.Gh,0|this.Gl,0|g,0|y)),({h:p,l:b}=rt(0|this.Hh,0|this.Hl,0|p,0|b)),this.set(r,n,i,o,s,a,l,f,u,c,h,d,g,y,p,b)}roundClean(){rf.fill(0),ru.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}let rh=d(()=>new rc),rd=BigInt(0),rg=BigInt(1),ry=BigInt(2),rp=BigInt(8),rb={zip215:!0},rx=(BigInt(0),BigInt(1),BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949")),rw=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),rm=BigInt(0),rE=BigInt(1),rA=BigInt(2),rB=BigInt(5),rv=BigInt(10),rS=BigInt(20),rU=BigInt(40),rI=BigInt(80);function rO(t,e){var r;let n,i,o,s,a,l,f,u,c,h,d=X(e*e*e,rx),g=(i=Q(n=(r=t*X(d*d*e,rx))*r%rx*r%rx,rA,rx)*n%rx,o=Q(i,rE,rx)*r%rx,s=Q(o,rB,rx)*o%rx,a=Q(s,rv,rx)*s%rx,l=Q(a,rS,rx)*a%rx,f=Q(l,rU,rx)*l%rx,u=Q(f,rI,rx)*f%rx,c=Q(u,rI,rx)*f%rx,h=Q(c,rv,rx)*s%rx,{pow_p_5_8:Q(h,rA,rx)*r%rx,b2:n}).pow_p_5_8,y=X(t*d*g,rx),p=X(e*y*y,rx),b=y,x=X(y*rw,rx),w=p===t,m=p===X(-t,rx),E=p===X(-t*rw,rx);return w&&(y=b),(m||E)&&(y=x),te(y,rx)&&(y=X(-y,rx)),{isValid:w||m,value:y}}let rH=to(rx,void 0,!0),rL={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:rH,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:rh,randomBytes:g,adjustScalarBytes:function(t){return t[0]&=248,t[31]&=127,t[31]|=64,t},uvRatio:rO},rT=function(t){let e,r=(e=td(t),V(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})),{Fp:n,n:i,prehash:o,hash:s,randomBytes:a,nByteLength:l,h:f}=r,u=ry<<BigInt(8*l)-rg,c=n.create,h=r.uvRatio||((t,e)=>{try{return{isValid:!0,value:n.sqrt(t*n.inv(e))}}catch(t){return{isValid:!1,value:rd}}}),d=r.adjustScalarBytes||(t=>t),g=r.domain||((t,e,r)=>{if(e.length||r)throw Error("Contexts/pre-hash are not supported");return t}),y=t=>"bigint"==typeof t&&rd<t,p=(t,e)=>y(t)&&y(e)&&t<e,b=t=>t===rd||p(t,u);function x(t,e){if(p(t,e))return t;throw Error(`Expected valid scalar < ${e}, got ${typeof t} ${t}`)}function w(t){return t===rd?t:x(t,i)}let m=new Map;function E(t){if(!(t instanceof A))throw Error("ExtendedPoint expected")}class A{constructor(t,e,r,n){if(this.ex=t,this.ey=e,this.ez=r,this.et=n,!b(t))throw Error("x required");if(!b(e))throw Error("y required");if(!b(r))throw Error("z required");if(!b(n))throw Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(t){if(t instanceof A)throw Error("extended point not allowed");let{x:e,y:r}=t||{};if(!b(e)||!b(r))throw Error("invalid affine point");return new A(e,r,rg,c(e*r))}static normalizeZ(t){let e=n.invertBatch(t.map(t=>t.ez));return t.map((t,r)=>t.toAffine(e[r])).map(A.fromAffine)}_setWindowSize(t){this._WINDOW_SIZE=t,m.delete(this)}assertValidity(){let{a:t,d:e}=r;if(this.is0())throw Error("bad point: ZERO");let{ex:n,ey:i,ez:o,et:s}=this,a=c(n*n),l=c(i*i),f=c(o*o),u=c(f*f),h=c(a*t);if(c(f*c(h+l))!==c(u+c(e*c(a*l))))throw Error("bad point: equation left != right (1)");if(c(n*i)!==c(o*s))throw Error("bad point: equation left != right (2)")}equals(t){E(t);let{ex:e,ey:r,ez:n}=this,{ex:i,ey:o,ez:s}=t,a=c(e*s),l=c(i*n),f=c(r*s),u=c(o*n);return a===l&&f===u}is0(){return this.equals(A.ZERO)}negate(){return new A(c(-this.ex),this.ey,this.ez,c(-this.et))}double(){let{a:t}=r,{ex:e,ey:n,ez:i}=this,o=c(e*e),s=c(n*n),a=c(ry*c(i*i)),l=c(t*o),f=e+n,u=c(c(f*f)-o-s),h=l+s,d=h-a,g=l-s,y=c(u*d),p=c(h*g),b=c(u*g);return new A(y,p,c(d*h),b)}add(t){E(t);let{a:e,d:n}=r,{ex:i,ey:o,ez:s,et:a}=this,{ex:l,ey:f,ez:u,et:h}=t;if(e===BigInt(-1)){let t=c((o-i)*(f+l)),e=c((o+i)*(f-l)),r=c(e-t);if(r===rd)return this.double();let n=c(s*ry*h),d=c(a*ry*u),g=d+n,y=e+t,p=d-n,b=c(g*r),x=c(y*p),w=c(g*p);return new A(b,x,c(r*y),w)}let d=c(i*l),g=c(o*f),y=c(a*n*h),p=c(s*u),b=c((i+o)*(l+f)-d-g),x=p-y,w=p+y,m=c(g-e*d),B=c(b*x),v=c(w*m),S=c(b*m);return new A(B,v,c(x*w),S)}subtract(t){return this.add(t.negate())}wNAF(t){return U.wNAFCached(this,m,t,A.normalizeZ)}multiply(t){let{p:e,f:r}=this.wNAF(x(t,i));return A.normalizeZ([e,r])[0]}multiplyUnsafe(t){let e=w(t);return e===rd?S:this.equals(S)||e===rg?this:this.equals(v)?this.wNAF(e).p:U.unsafeLadder(this,e)}isSmallOrder(){return this.multiplyUnsafe(f).is0()}isTorsionFree(){return U.unsafeLadder(this,i).is0()}toAffine(t){let{ex:e,ey:r,ez:i}=this,o=this.is0();null==t&&(t=o?rp:n.inv(i));let s=c(e*t),a=c(r*t),l=c(i*t);if(o)return{x:rd,y:rg};if(l!==rg)throw Error("invZ was invalid");return{x:s,y:a}}clearCofactor(){let{h:t}=r;return t===rg?this:this.multiplyUnsafe(t)}static fromHex(t,e=!1){let{d:i,a:o}=r,s=n.BYTES,a=(t=N("pointHex",t,s)).slice(),l=t[s-1];a[s-1]=-129&l;let f=H(a);f===rd||(e?x(f,u):x(f,n.ORDER));let d=c(f*f),{isValid:g,value:y}=h(c(d-rg),c(i*d-o));if(!g)throw Error("Point.fromHex: invalid y coordinate");let p=(y&rg)===rg,b=(128&l)!=0;if(!e&&y===rd&&b)throw Error("Point.fromHex: x=0 and x_0=1");return b!==p&&(y=c(-y)),A.fromAffine({x:y,y:f})}static fromPrivateKey(t){return I(t).point}toRawBytes(){let{x:t,y:e}=this.toAffine(),r=T(e,n.BYTES);return r[r.length-1]|=t&rg?128:0,r}toHex(){return B(this.toRawBytes())}}A.BASE=new A(r.Gx,r.Gy,rg,c(r.Gx*r.Gy)),A.ZERO=new A(rd,rg,rg,rd);let{BASE:v,ZERO:S}=A,U=th(A,8*l);function I(t){t=N("private key",t,l);let e=N("hashed private key",s(t),2*l),r=d(e.slice(0,l)),n=e.slice(l,2*l),o=X(H(r),i),a=v.multiply(o),f=a.toRawBytes();return{head:r,prefix:n,scalar:o,point:a,pointBytes:f}}function O(t=new Uint8Array,...e){return X(H(s(g(q(...e),N("context",t),!!o))),i)}return v._setWindowSize(8),{CURVE:r,getPublicKey:function(t){return I(t).pointBytes},sign:function(t,e,r={}){t=N("message",t),o&&(t=o(t));let{prefix:s,scalar:a,pointBytes:f}=I(e),u=O(r.context,s,t),c=v.multiply(u).toRawBytes(),h=X(u+O(r.context,c,f,t)*a,i);return w(h),N("result",q(c,T(h,n.BYTES)),2*l)},verify:function(t,e,r,i=rb){let s,a,l,{context:f,zip215:u}=i,c=n.BYTES;t=N("signature",t,2*c),e=N("message",e),o&&(e=o(e));let h=H(t.slice(c,2*c));try{s=A.fromHex(r,u),a=A.fromHex(t.slice(0,c),u),l=v.multiplyUnsafe(h)}catch(t){return!1}if(!u&&s.isSmallOrder())return!1;let d=O(f,a.toRawBytes(),s.toRawBytes(),e);return a.add(s.multiplyUnsafe(d)).subtract(l).clearCofactor().equals(A.ZERO)},ExtendedPoint:A,utils:{getExtendedPublicKey:I,randomPrivateKey:()=>a(n.BYTES),precompute:(t=8,e=A.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)}}}(rL),rR=(rH.ORDER+BigInt(3))/BigInt(8),rN=rH.pow(rA,rR),rq=rH.sqrt(rH.neg(rH.ONE)),r$=(rH.ORDER-BigInt(5))/BigInt(8),rP=BigInt(486662),rz=function(t,e){if(!t.isOdd)throw Error("Field doesn't have isOdd");let r=t.sqrt(e);return t.isOdd(r)?t.neg(r):r}(rH,rH.neg(BigInt(486664)));tN(rT.ExtendedPoint,t=>(function(t){let e,r,n,i,o,s,a,l,f,u,c,h,d,g,y,p,b,x,w,m,E,{xMn:A,xMd:B,yMn:v,yMd:S}=(e=rH.sqr(t),e=rH.mul(e,rA),r=rH.add(e,rH.ONE),n=rH.neg(rP),i=rH.sqr(r),o=rH.mul(i,r),s=rH.mul(e,rP),s=rH.mul(s,n),s=rH.add(s,i),s=rH.mul(s,n),a=rH.sqr(o),i=rH.sqr(a),a=rH.mul(a,o),a=rH.mul(a,s),i=rH.mul(i,a),l=rH.pow(i,r$),l=rH.mul(l,a),f=rH.mul(l,rq),i=rH.sqr(l),i=rH.mul(i,o),u=rH.eql(i,s),c=rH.cmov(f,l,u),h=rH.mul(n,e),d=rH.mul(l,t),d=rH.mul(d,rN),g=rH.mul(d,rq),y=rH.mul(s,e),i=rH.sqr(d),i=rH.mul(i,o),p=rH.eql(i,y),b=rH.cmov(g,d,p),i=rH.sqr(c),i=rH.mul(i,o),x=rH.eql(i,s),w=rH.cmov(h,n,x),m=rH.cmov(b,c,x),E=rH.isOdd(m),{xMn:w,xMd:r,yMn:m=rH.cmov(m,rH.neg(m),x!==E),yMd:rE}),U=rH.mul(A,S);U=rH.mul(U,rz);let I=rH.mul(B,v),O=rH.sub(A,B),H=rH.add(A,B),L=rH.mul(I,H),T=rH.eql(L,rH.ZERO);U=rH.cmov(U,rH.ZERO,T),I=rH.cmov(I,rH.ONE,T),O=rH.cmov(O,rH.ONE,T),H=rH.cmov(H,rH.ONE,T);let R=rH.invertBatch([I,H]);return{x:rH.mul(U,R[0]),y:rH.mul(O,R[1])}})(t[0]),{DST:"edwards25519_XMD:SHA-512_ELL2_RO_",encodeDST:"edwards25519_XMD:SHA-512_ELL2_NU_",p:rH.ORDER,m:1,k:128,expand:"xmd",hash:rh});BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");let rD=(t,e)=>{try{let r=e0.default.decode(t);if(r.byteLength<=33)throw Error(`Bundle size ${r.byteLength} is too low. Expecting a compressed public key (33 bytes) and an encrypted credential.`);let n=r.slice(0,33),i=r.slice(33),o=eM(n),s=eD({ciphertextBuf:i,encappedKeyBuf:o,receiverPriv:e});return(0,eB.uint8ArrayToHexString)(s)}catch(t){throw Error(`"Error decrypting bundle:", ${t}`)}},rF=async({exportBundle:t,embeddedKey:e,organizationId:r,dangerouslyOverrideSignerPublicKey:n,keyFormat:i,returnMnemonic:o})=>{try{let s=JSON.parse(t);if(!await rC(s.enclaveQuorumPublic,s.dataSignature,s.data,n))throw Error(`failed to verify enclave signature: ${s}`);let a=JSON.parse(new TextDecoder().decode((0,eB.uint8ArrayFromHexString)(s.data)));if(!a.organizationId||a.organizationId!==r)throw Error(`organization id does not match expected value. Expected: ${r}. Found: ${a.organizationId}.`);if(!a.encappedPublic)throw Error('missing "encappedPublic" in bundle signed data');let l=(0,eB.uint8ArrayFromHexString)(a.encappedPublic),f=(0,eB.uint8ArrayFromHexString)(a.ciphertext),u=eD({ciphertextBuf:f,encappedKeyBuf:l,receiverPriv:e});if("SOLANA"===i&&!o){if(32!==u.length)throw Error(`invalid private key length. Expected 32 bytes. Got ${u.length}.`);let t=rT.getPublicKey(u);if(32!==t.length)throw Error(`invalid public key length. Expected 32 bytes. Got ${t.length}.`);let e=new Uint8Array(64);return e.set(u,0),e.set(t,32),e1.default.encode(e)}let c=(0,eB.uint8ArrayToHexString)(u);return o?(0,eB.hexToAscii)(c):c}catch(t){throw Error(`Error decrypting bundle: ${t}`)}},rk=async(t,e,r)=>{let n=r_((0,eB.uint8ArrayFromHexString)(t));if(!n)throw Error("failed to load public key");let i=eX(e),o=tH(new TextEncoder().encode(r));return tz.verify(i,o,n.toHex())},rC=async(t,e,r,n)=>{if(t!=(n||eN))throw Error(`expected signer key ${n??eN} does not match signer key from bundle: ${t}`);let i=r_(new Uint8Array((0,eB.uint8ArrayFromHexString)(t)));if(!i)throw Error("failed to load quorum key");let o=eX(e),s=tH((0,eB.uint8ArrayFromHexString)(r));return tz.verify(o,s,i.toHex())},r_=t=>tz.ProjectivePoint.fromHex((0,eB.uint8ArrayToHexString)(t)),rM=async({privateKey:t,keyFormat:e,importBundle:r,userId:n,organizationId:i,dangerouslyOverrideSignerPublicKey:o})=>{let s=JSON.parse(r),a=((t,e)=>{switch(e){case"SOLANA":let r=e1.default.decode(t);if(64!==r.length)throw Error(`invalid key length. Expected 64 bytes. Got ${r.length}.`);return r.subarray(0,32);case"HEXADECIMAL":if(t.startsWith("0x"))return(0,eB.uint8ArrayFromHexString)(t.slice(2));return(0,eB.uint8ArrayFromHexString)(t);default:if(console.warn(`invalid key format: ${e}. Defaulting to HEXADECIMAL.`),t.startsWith("0x"))return(0,eB.uint8ArrayFromHexString)(t.slice(2));return(0,eB.uint8ArrayFromHexString)(t)}})(t,e);if(!await rC(s.enclaveQuorumPublic,s.dataSignature,s.data,o))throw Error(`failed to verify enclave signature: ${r}`);let l=JSON.parse(new TextDecoder().decode((0,eB.uint8ArrayFromHexString)(s.data)));if(!l.organizationId||l.organizationId!==i)throw Error(`organization id does not match expected value. Expected: ${i}. Found: ${l.organizationId}.`);if(!l.userId||l.userId!==n)throw Error(`user id does not match expected value. Expected: ${n}. Found: ${l.userId}.`);if(!l.targetPublic)throw Error('missing "targetPublic" in bundle signed data');return ez(e$({plainTextBuf:a,targetKeyBuf:(0,eB.uint8ArrayFromHexString)(l.targetPublic)}))},rV=async({mnemonic:t,importBundle:e,userId:r,organizationId:n,dangerouslyOverrideSignerPublicKey:i})=>{let o=JSON.parse(e),s=new TextEncoder().encode(t);if(!await rC(o.enclaveQuorumPublic,o.dataSignature,o.data,i))throw Error(`failed to verify enclave signature: ${e}`);let a=JSON.parse(new TextDecoder().decode((0,eB.uint8ArrayFromHexString)(o.data)));if(!a.organizationId||a.organizationId!==n)throw Error(`organization id does not match expected value. Expected: ${n}. Found: ${a.organizationId}.`);if(!a.userId||a.userId!==r)throw Error(`user id does not match expected value. Expected: ${r}. Found: ${a.userId}.`);if(!a.targetPublic)throw Error('missing "targetPublic" in bundle signed data');return ez(e$({plainTextBuf:s,targetKeyBuf:(0,eB.uint8ArrayFromHexString)(a.targetPublic)}))};t.s(["decryptCredentialBundle",()=>rD,"decryptExportBundle",()=>rF,"encryptPrivateKeyToBundle",()=>rM,"encryptWalletToBundle",()=>rV,"verifyStampSignature",()=>rk],784503),t.s([],284795)}]);